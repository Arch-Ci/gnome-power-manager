2006-01-29  Raphael Higino  <raphaelh@cvs.gnome.org>

	* configure.in: Added pt_BR to ALL_LINGUAS.

2006-01-29  Chao-Hsiung Liao  <j_h_liau@yahoo.com.tw>

	* configure.in: Add "zh_HK" "zh_TW" to ALL_LINGUAS.

2006-01-28 Jaap Haitsma  <jaap@haitsma.org>

	* gpm-manager.c : Oops my previous checkin did not compile

2006-01-28 Jaap Haitsma  <jaap@haitsma.org>

	* gpm-power.c: (battery_kind_cache_update) refactor.
	
	Move percentagecharged to gpm-manager.c. gpm-power.c should just give
	current status. gpm-manager.c should monitor this
	
	* gpm-marshal.list: take into account that percentagechanged is not
	anymore in the signal of power changed

	* gpm-manager.c: Add private variable done_notification_fully_charged to
	prevent fully charged being shown multiple times
	
	Fixes bug #328958

2006-01-28  Christopher Aillon  <caillon@redhat.com>

	* data/Makefile.am:
	* data/gnome-power-manager.spec.in:
	Fix the autostart file location to match the spec

2006-01-28  Richard Hughes  <richard@hughsie.com>

	* SConstruct, sconstools/*: Add the scons build framework.
	BJÃ¶rn Lindqvist has provied a framework for g-p-m that lets us build
	using the new scons framework (which I've been testing for a few weeks).
	The old autotools system will remain as default, as it works.

2006-01-28 Jaap Haitsma  <jaap@haitsma.org>

	* gpm-manager.c: Remove doxygen comments for functions

	(maybe_notify_battery_power_changed): simplify logic to make sure that
	notifications are shown only once. Move tray_icon_update to 
	power_battery_power_changed_cb

	(maybe_notify_on_ac_changed) move tray_icon_update call to 
	power_on_ac_changed_cb

	(invalidate_notification_warnings) Remove this function
	
	Fixes bug #328759

2006-01-25  Richard Hughes  <richard@hughsie.com>

	* configure.in: Post release bump to 2.13.90

2006-01-25  Richard Hughes  <richard@hughsie.com>

	==== Version 2.13.5 ====

2006-01-25  Richard Hughes  <richard@hughsie.com>

	* src/gpm-manager.c: Add the done_warning_critical,
	done_warning_very_low, done_warning_low bools to the struct so we can
	keep knowledge of previous notifications.

	(maybe_notify_battery_power_changed): Change to NOT primary OR 
	NOT discharging as the logic was wrong. Should fix bug (#328228)
	Also only do the notifications once, and don't do lots of 
	notifications on startup if battery is very low. (#327963)

	(invalidate_notification_warnings): Add this function so we can
	reset the notification accounting, which we want to do if we go from
	battery -> AC -> battery.

	(power_battery_power_changed_cb): Do a libnotify warning stating the
	action 5 seconds before we do the critical action. We should always
	explain the action we are going to do.

2006-01-25  Richard Hughes  <richard@hughsie.com>

	* data/gnome-power-manager.schemas.in: Add the dim_on_idle gconf key
	so we can work on this functionality after the string freeze.

2006-01-25  Richard Hughes  <richard@hughsie.com>

	* src/gpm-manager.c (power_battery_power_changed_cb): Only do action
	when discharging, trying to fix bug (#328228)

2006-01-25  Richard Hughes  <richard@hughsie.com>

	* src/gpm-prefs.h: "policy_can_hibernate" -> "can_hibernate" Dohh.

2006-01-24  Richard Hughes  <richard@hughsie.com>

	* src/gpm-prefs.c (gpm_prefs_setup_action_combo): Don't segfault if
	gconf value is missing, just issue warning.

	* data/gnome-power-manager.schemas.in: Remove the elusive "j"
	Also change the default brightnesses for AC to be 100, and battery 50.

2006-01-24  Richard Hughes  <richard@hughsie.com>

	* src/gpm-manager.c:
	Define the BATTERY_*_REMAINING_TIME constants.

	(maybe_notify_battery_power_changed): Only warn on primary battery,
	and also provide two methods for working out the notifications, to try
	to keep the peace for bug (#326743). This is based on a patch from
	Jaap, to change the notifications to time-remaining values rather than
	percentage charge.

	(power_battery_power_changed_cb): Invalidate the prior warning level
	as the power state has changed.

	(gpm_manager_init): Invalidate the warning level, and set the default
	to per-time rather than per-percentage. We can change this easily if
	this doesn't work in real world conditions, or perhaps make this a
	gconf configurable.

	(power_battery_power_changed_cb): Only do critical action on primary
	battery, fixing bug (#328228). Patch originally from Jaap.

2006-01-24  Richard Hughes  <richard@hughsie.com>

	* data/gnome-power-manager.schemas.in, src/gpm-prefs.h:
	Flattern the gconf schema so that we don't have lots of subfolders
	for very few keys.

	* data/gnome-power-manager.schemas.in, src/gpm-prefs.h,
	gpm-manager.c (gpm_manager_can_suspend, gpm_manager_can_hibernate):
	Query the can_suspend and can_hibernate keys to fix bug (#327894)

2006-01-24  Richard Hughes  <richard@hughsie.com>

	* data/gpm-prefs.glade: Do a 
	s/"Power Preferences"/"Power Management Preferences" to fix the
	bug (#328397)

2006-01-24  William Jon McCann  <mccann@jhu.edu>

	* src/gpm-tray-icon.c (gpm_tray_icon_button_press_cb):
	Show menu for any button press.  Fixes #327959.

2006-01-24  Richard Hughes  <richard@hughsie.com>

	* data/gnome-power-manager.spec.in: Add %{_datadir}/autostart/* so that
	the rpm builds.

2006-01-24  Richard Hughes  <richard@hughsie.com>

	* data/Makefile.am: Fix up Rodrigo's commit so "make distcheck" works

2006-01-24  Richard Hughes  <richard@hughsie.com>

	* src/gpm-power.c (power_get_summary_for_kind),
	src/gpm-prefs.c (gpm_prefs_format_time_cb),
	src/gpm-manager.c (maybe_notify_battery_power_changed),
	src/gpm-common.{h|c},

	Convert s\get_timestring_from_minutes\gpm_get_timestring so we now take
	seconds as the argument. This fixes bug (#328289).

2006-01-24  Richard Hughes  <richard@hughsie.com>

	* docs/www/images/*, docs/www/*: Remove as this is already in 
	gnomeweb-wml CVS. Fixes bug (#328280).

2006-01-24  Richard Hughes  <richard@hughsie.com>

	* src/gpm-manager.c: Add the FIXME constants BATTERY_LOW_PERCENTAGE
	and BATTERY_CRITICAL_PERCENTAGE so we can get 99% of the patch of
	http://bugzilla.gnome.org/show_bug.cgi?id=326743 in CVS.

2006-01-24  Jaap Haitsma  <jaap@haitsma.org>

	* data/gnome-power-manager.schemas.in: Remove threshold_low, 
	threshold_critical

	* data/gpm-prefs.glade: Remove threshold_low, threshold_critical sliders

	* src/gpm-prefs.{c|h}: Remove threshold_low, threshold_critical sliders
	and preferences

2006-01-24  Clytie Siddall <clytie@riverland.net.au>

	* configure.in	Added vi in ALL_LINGUAS line.
	
2006-01-23  Rodrigo Moya <rodrigo@novell.com>

	* data/gnome-power-manager.desktop.in:
	* data/Makefile.am: added .desktop file for gnome-session's
	autostart mechanism.

2006-01-23  Richard Hughes  <richard@hughsie.com>

	* configure.in: Add fexceptions to the configure line as it makes
	g-p-m blow up while testing if the signals are wrong (good thing).

	* src/gpm-hal-monitor.c (gpm_hal_monitor_class_init): Change
	gpm_marshal_VOID__STRING_STRING to gpm_marshal_VOID__STRING as we
	only send one argument.

	* src/gpm-power.c (hal_battery_added_cb): Remove the reserved parameter
	as it's not used anywhere and only confuses us. This should fix the bug
	where the g-p-m crashes and "gdb bt" intermittently gives:
	hal_monitor_start->gpm_coldplug_batteries->g_signal_emit->
	g_signal_emit_valist->g_value_array_copy->g_strdup->strlen

2006-01-23  Richard Hughes  <richard@hughsie.com>

	* src/gpm-brightness.c (gpm_brightness_init): Actually check for the
	hardware so we don't get errors on desktop systems.

2006-01-22  Richard Hughes  <richard@hughsie.com>

	* src/gpm-manager.c (gpm_manager_init): Add a call to 
	change_power_policy () so we set the correct lcd brightness on
	startup. This meant that the lcd brightness was not being set on
	the first cold boot of g-p-m.

2006-01-22  Richard Hughes  <richard@hughsie.com>

	* src/gpm-brightness.{c|h}: Add these files which abstract out the
	lcd brightness interface nicely. The new class internally deals with
	the hardware values (0..x) and externally deals with percentages
	so that the changes recently in g-g_signal_emitp-p to store percentage now work.

	* src/Makefile.am: Add gpm-brightness.{c|h} to g-p-m.

	* src/gpm-hal.{h|c}: Remove all the LCD brightness code. This was
	always a bodge putting it in this file, and now it's faster and
	cleaner in the new class.

	* src/gpm-manager.c: Adapt for the new lcd brightness function names.
	Also add the code to change the brightness when we change the
	gconf key in g-p-p. This fixes (#327895).

2006-01-22  Richard Hughes  <richard@hughsie.com>

	* docs/release-plan.txt: Add this file, so I can follow a tick sheet
	for a formal release :-)

2006-01-22  Richard Hughes  <richard@hughsie.com>

	* Makefile.am: Add MAINTAINERS to the tarball, advice from Behdad,
	http://mces.blogspot.com/2006/01/release-your-maintainers.html

2006-01-22  Richard Hughes  <richard@hughsie.com>

	* src/gpm-hal-monitor.c (watch_device_condition): Find the UDI from
	the proxy path, as before we were just reading random data...

2006-01-22  Richard Hughes  <richard@hughsie.com>

	* docs/dbus-interface.txt: Document CanSuspend and CanHibernate.

2006-01-21  Richard Hughes  <richard@hughsie.com>

	* src/gpm-manager.c (gpm_manager_init): Add a call to tray_icon_update
	so that desktop systems get an icon if specified in gconf.
	Fixes problems described in #327799, Comment 16.

2006-01-21  Richard Hughes  <richard@hughsie.com>

	* src/gpm-tray-icon.c (gpm_tray_icon_set_image_from_stock): Comment out
	gtk_image_clear() as it requires gtk 2.8. For FC4 we can't depend on
	more then 2.6. No visual change.

2006-01-20  William Jon McCann  <mccann@jhu.edu>

	* src/gpm-tray-icon.c (gpm_tray_icon_set_image_from_stock):
	Interpret a NULL stock id as no icon.
	(gpm_tray_icon_embedded): Set a flag when embedded in
	a socket.
	(gpm_tray_icon_class_init, gpm_tray_icon_notify): If
	not embedded don't do notifications.

	* src/gpm-manager.c (get_stock_id): Return in one place.
	(tray_icon_update, maybe_notify_on_ac_changed) 
	(maybe_notify_battery_power_changed): Don't try to
	send notifications if we don't have a tray icon.  Move
	policy do out of here.
	(power_battery_power_changed_cb): Do the policy action
	here.

	Fixes #327799.

2006-01-20  William Jon McCann  <mccann@jhu.edu>
	
	* src/gpm-power.c: (power_get_summary_for_kind) Make tooltip more
	concise. Make some comments clearer or remove them.
	* src/gpm-common.c: return "Unknown time" if minutes <=0 for
 	get_timestring_from_minutes ()

	Patch from Jaap Haitsma  <jaap@haitsma.org>
	Fixes #327443
	
2006-01-20  William Jon McCann  <mccann@jhu.edu>

	* src/gpm-prefs.h: Use enum for icon policy.

	* src/gpm-prefs.c (gpm_dbus_method_bool, gpm_can_suspend) 
	(gpm_can_hibernate): Check with the daemon to see if
	we are capable and allowed to do these things.
	(gpm_has_batteries, gpm_has_lcd, gpm_has_button_sleep) 
	(gpm_has_button_lid): Make functions to check these
	things.
	(gpm_prefs_icon_radio_cb): Don't leak gconf client.
	(gpm_prefs_format_brightness_cb): Don't use
	device dependent lcdsteps.
	(gpm_prefs_format_percentage_cb): Don't cast to int
	to guard against overflow.
	(gpm_prefs_format_time_cb): Use one return.
	(gpm_prefs_sleep_slider_changed_cb): Don't leak client.
	(gpm_prefs_setup_sleep_slider): ditto.
	(gpm_prefs_brightness_slider_changed_cb): Don't leak
	client.  Don't try to change brightness of devices here.
	(gpm_prefs_setup_brightness_slider): Don't leak client.
	Don't use device dependent lcdsteps.
	(gpm_prefs_action_combo_changed_cb): Don't leak.
	(gpm_prefs_setup_action_combo): Don't leak.  Use
	local _can_ functions instead of checking HAL directly
	so that we can also check gconf policy.
	(gpm_prefs_battery_low_slider_changed_cb): Don't leak.
	(setup_page_one, setup_page_two, setup_page_three) 
	(gpm_prefs_create): Break up the creation and setup
	of each notebook tab to make it less monolithic.

	* src/gpm-manager.xml: Add CanSuspend, CanHibernate,
	and CanShutdown.

	* src/gpm-manager.[ch] (gpm_manager_can_suspend) 
	(gpm_manager_can_hibernate, gpm_manager_can_shutdown):
	Make these methods public and expose to the bus.
	(get_stock_id): Make icon_policy an enum so
	we don't have to parse and compare strings.
	(tray_icon_update): Convert gconf icon-policy
	string to an enum for internal use.
	(gpm_manager_shutdown, gpm_manager_hibernate) 
	(gpm_manager_suspend, gpm_manager_setup_tray_icon):
	Use new API for _can_ functions.

	* src/Makefile.am: Don't need gpm-screensaver
	for prefs.

	* data/gpm-prefs.glade: Remove time estimates
	for low and critical battery since this is
	device and system dependent.

2006-01-19  William Jon McCann  <mccann@jhu.edu>

	* src/Makefile.am:
	* src/gpm-hal-callback.[ch]: Remove hal-callback.

	* src/gpm-hal-monitor.c: Don't use hal-callback
	to get HAL signals.  Do it here.

	Fixes #327235

2006-01-19  William Jon McCann  <mccann@jhu.edu>

	* src/gpm-prefs.c (gpm_prefs_help_cb): Use gnome_help.
	Fixes #326890

2006-01-18  Richard Hughes  <richard@hughsie.com>

	* src/gpm-manager.c (maybe_notify_battery_power_changed):
	Revert the 20, 10, 5, and 2 checks. Definatly needs more work.
	Apologies, brain was not in gear.

2006-01-18  Richard Hughes  <richard@hughsie.com>

	* src/gpm-power.c (battery_kind_cache_add_device): Turn the warning
	about "Adding missing device, may bug" into a debug statement, as this
	is now well tested.

	* src/gpm-manager.c (maybe_notify_battery_power_changed):
	Only notify the user of low battery on the 20, 10, 5, and 2 
	minute intervals. Probably needs more work.

2006-01-18  Richard Hughes  <richard@hughsie.com>

	* data/gpm-prefs.glade: Make the combo bokes in options expand so that
	we don't get comboboxes of different sizes.

2006-01-18  William Jon McCann  <mccann@jhu.edu>

	* src/gpm-power.c (battery_kind_cache_update): Use floating
	point division to get a fraction.  Don't declare a variable
	in the middle of a block.  Use spaces around all operators.
	Use braces around blocks.
	(power_get_summary_for_kind): Use spaces around operators.
	Fix case where !is-charging && !is-discharging.
	Fixes #327471

2006-01-18  Richard Hughes  <richard@hughsie.com>

	* src/gpm-main.c (gpm_signal_handler_noc, signalhandler_noc):
	Be less vocal about changes in the bus -- we only want to know about
	g-p-m and hal, not everything else.

2006-01-17  Adam Weinberger  <adamw@gnome.org>

	* data/gnome-power-manager.schemas.in: Correct two typos.
	  Fixes bug #327396.

2006-01-17  Richard Hughes  <richard@hughsie.com>

	* src/gpm-manager.c (gpm_manager_init):
	Do not do tray_icon_update () in the initialization, else
	we get an ac_adapter icon for a split second (as state is unknown)
	then a battery icon.

	* src/gpm-manager.c (maybe_notify_battery_power_changed),
	* src/gpm-manager.c (maybe_notify_on_ac_changed):
	Remove the checks on manager->priv->tray_icon, as the icon does not
	have to exist before entering these functions.
	* src/gpm-tray-icon.c (gpm_tray_icon_init): Don't initialise this
	to the ac_adapter icon, use a blank image instead.

2006-01-17  Jaap Haitsma  <jaap@haitsma.org>

	* AUTHORS: Add myself.

	* src/gpm-tray-icon.c: Add myself as an author.

	* src/gpm-power.{c|h}: Fix multi battery setups. Change remaining time
	to seconds instead of minutes.

	* src/gpm-manager.c: Use seconds instead of minutes

2006-01-17  Richard Hughes  <richard@hughsie.com>

	* configure.in, NEWS: Update version to 2.13.5 so we match the GNOME
	version numbers. I know I missed the tarball deadline.

	doc/www/index.html: Update version requirements for HAL.

	* doc/www/images/gpm-about.png, doc/www/images/pref-options.png, 
	doc/www/images/pref-main.png, doc/www/images/pref-advanced.png:
	Update to something more modern -- I've synced gnomeweb-wml too.

2006-01-17  Richard Hughes  <richard@hughsie.com>

	* src/gpm-main.h, src/Makefile.am, po/POTFILES.in:
	Remove this non-required file.

	* src/gpm-prefs.c, src/gpm-common.h, src/gpm-tray-icon.c,
	src/gpm-main.c, src/gpm-hal-monitor.c: Fix so that our name is 
	"Power Manager" rather than "GNOME Power Manager" in the warnings
	and menus so that we adhere to the GNOME HIG (#327277)

2006-01-16  Richard Hughes  <richard@hughsie.com>

	* autogen.sh: Now that omf.make has been removed, we should really tell
	gnome-common that we are using USE_COMMON_DOC_BUILD.

	* src/gpm-tray-icon.c: Fix the !libnotify build.
	Also switch HAVE_LIBNOTIFY to LIBNOTIFY_VERSION_MINOR >=2 so we can
	easily build with scons.

	* src/gpm-stock-icons.c: Fix the scons build by including config.h

	* po/*: Do a intltool-update --pot && make update-po to freshen up the
	translations.

	* src/gpm-dbus-client.{h|c}, src/Makefile.am, po/POTFILES.in:
	Remove these non-required files. (#327236)

	* data/gnome-power-manager.schemas.in:
	Update the descriptions, and add a few more <short> and <long> tags.
	Remove the hard-drive spindown keys also, we don't use them anymore.
	Also make all the time values in seconds.

	* src/gpm-idle, src/gpm-manager.c, src/gpm-prefs.c: Update, as now all
	the gconf values are in seconds. (#327007)

	* src/gpm-power.c (add_battery): Add a warning for a low capacity
	battery, to start to fix (#326740) -- yet more work required.

2006-01-14  William Jon McCann  <mccann@jhu.edu>

	* data/gpm-prefs.glade: A few HIG spacing fixes.  This makes
	it look the same as g-v-m.

2006-01-13  Richard Hughes  <richard@hughsie.com>

	* src/gpm-power.c: Fix newline logic to be the same as before (so it 
	doesn't truncate the last bracket in some cases).
	Also replace spaces-for-tabs in this file with actual tabs.

	* src/gpm-marshal.list, src/gpm-manager.c, src/gpm-power.c:
	Add a parameter "charging" and "percentagechanged" which lets us veto
	some actions when doing the initial startup. This stops the message
	"Your battery is fully charged"	when starting g-p-m with a full battery.
	Also unconditionally send a signal battery-power-changed when *any*
	battery property changes, so that the icon changes when !charging
	as this was not being done.

	* MAINTAINERS: I have a name, I am not an email address.

	* CodingStyle: Update with suggestions from (#326515)

	* src/gpm-power.c (battery_kind_cache_update): Always send a
	BATTERY_POWER_CHANGED signal when devices disappear.

	* src/gpm-power.c (gpm_power_get_battery_percentage): Return false
	when a BatteryKindCacheEntry is marked as not present, as ACPI
	batteries are not removed from HAL when they are removed.
	This fixes (#326865)

	* docs/www/*.html: Update the archive links, and make sure the header
	is bold for each section.

	* src/gpm-tray-icon.c (gpm_tray_icon_show_help_cb):
	Replace spaces-for-tabs with actual tabs.

2006-01-12  William Jon McCann  <mccann@jhu.edu>

	* src/gpm-power.[ch]: New powered device handling.

	* src/gpm-prefs.c: Fix compiler warning.

	* src/gpm-marshal.list: Add new one.

	* src/gpm-manager.xml: Remove set_on_ac from API.

	* src/gpm-manager.[ch]: Don't manage on-ac state.
	(get_stock_id): Remove all sysdev stuff.  Use gpm-power.
	(tray_icon_update): Get summary from gpm-power.
	(sync_dpms_policy): Use gpm-power for on-ac.
	(maybe_notify_battery_power_changed): Update for gpm-power.
	(gpm_manager_get_on_ac, dpms_mode_changed_cb) 
	(power_button_pressed, suspend_button_pressed) 
	(lid_button_pressed, power_button_pressed_cb) 
	(power_battery_power_changed_cb, gpm_manager_set_property) 
	(gpm_manager_get_property, callback_gconf_key_changed) 
	(gpm_manager_init, gpm_manager_finalize): Updates for gpm-power

	* src/gpm-main.c: Fix compiler warnings.

	* src/gpm-hal-monitor.c: Remove core and sysdev.  Make
	into a singleton.  Make signals a bit more generic.
	Primarily serve as a HAL proxy.

	* src/gpm-hal-callback.h: Fix prototypes.

	* src/gpm-dpms.h: Fix typo.

	* src/Makefile.am: Remove gpm-core and gpm-sysdev.
	Use found glib-genmarshal.

	* configure.in: Look for glib-genmarshal. Add
	extra warnings when building from CVS.

	Fixes #326515

2006-01-12  Richard Hughes  <richard@hughsie.com>

	* po/POTFILES.in: Remove gpm-dbus-signal-handler.{c|h} to fix
	make diskcheck.

	* src/gpm-hal.c (gpm_hal_can_suspend), (gpm_hal_can_hibernate):
	Fix logic so that is key is missing we do not do the action.
	Fixes bug http://bugzilla.gnome.org/show_bug.cgi?id=326552

2006-01-11  William Jon McCann  <mccann@jhu.edu>

	* src/gpm-tray-icon.c: Add missing includes.

	* src/gpm-sysdev.c (hal_to_device_type): Moved here from gpm-common.

	* src/gpm-prefs.c: Add missing includes.

	* src/gpm-manager.c: Add include for gnome-client.h and sysdev.
	(_gpm_manager_can_suspend, _gpm_manager_can_hibernate) 
	(_gpm_manager_can_shutdown): Add functions to use instead of
	calling HAL directly.
	(get_stock_id): Use our own on_ac property instead of calling HAL.
	(get_full_tooltip): Ditto.
	(gpm_manager_shutdown, gpm_manager_hibernate) 
	(gpm_manager_suspend): Call our own _can_ functions.
	(gpm_manager_setup_tray_icon): Ditto.

	* src/gpm-main.c
	* src/gpm-dbus-signal-handler.c: Moved functionality to gpm-main.

	* src/gpm-core.c: Include sysdev here.

	* src/gpm-common.[ch]: Don't depend on sysdev.  Don't use gnome.h
	and gconf.

	* src/Makefile.am: Remove gpm-console and gpm-dbus-signal-handler

2005-01-11  Richard Hughes  <richard@hughsie.com>

	* src/Makefile.am, src/gpm-dbus-client.c, src/gpm-idle.c, 
	src/gpm-hal.c, src/gpm-hal-callback.c, src/gpm-idle.c,
	src/gpm-manager.c, src/gpm-screensaver.c, src/gpm-prefs.c:
	Remove gpm-dbus-common from all the files. This file was originally
	used when the DBUS API was churning so all the changes could be done
	in one place. Now the glib DBUS api is stable, hardcode these simple
	functions in the respective places.

2006-01-10  William Jon McCann  <mccann@jhu.edu>

	* src/gpm-manager.c (hal_power_button_cb, hal_lid_button_cb):
	Add debug statements.

2006-01-10  William Jon McCann  <mccann@jhu.edu>

	* src/gpm-manager.c (manager_policy_do) 
	(gpm_manager_tray_icon_hibernate, gpm_manager_tray_icon_suspend):
	Actually do the action.  Forgot to fix this after Richard
	asked me to the other day.

2006-01-10  William Jon McCann  <mccann@jhu.edu>

	* src/gpm-manager.c (sync_dpms_policy):
	Check errors.
	(gpm_manager_set_dpms_mode, gpm_manager_get_dpms_mode) 
	(idle_changed_cb, dpms_mode_changed_cb, hal_lid_button_cb):
	Report errors back to DBUS.
	(gpm_manager_init): Rename signal.

	* src/gpm-dpms-x11.c (gpm_dpms_error_quark): Add errors.
	(x11_sync_server_dpms_settings): Set errors.
	Also allow zero timeouts as this is how we'll disable
	DPMS now that we enable it by default.
	(x11_get_mode, x11_set_mode): Use a more DBUSy
	design.
	(sync_settings): Use zero for timeouts instead of
	our configured ones when DPMS isn't active.
	(gpm_dpms_get_enabled, gpm_dpms_set_enabled, gpm_dpms_get_active) 
	(gpm_dpms_set_active, gpm_dpms_set_timeouts):
	Use DBUSy design.
	(gpm_dpms_set_mode): Allow mode to be set even
	if DPMS is not active.
	(gpm_dpms_get_mode): DBUSy design.
	(gpm_dpms_set_standby_timeout, gpm_dpms_set_suspend_timeout) 
	(gpm_dpms_set_off_timeout): Setters for properties.
	(gpm_dpms_set_property, gpm_dpms_get_property) 
	(gpm_dpms_class_init): Add properties and rename signal.

	Changes to allow setting DPMS mode while DPMS is not active
	and to report errors back to DBUS.

2005-01-10  Richard Hughes  <richard@hughsie.com>

	* src/icons/*: Move to data/icons/24x24

	* data/icons/svg: Add the svg images here too.

2006-01-10  William Jon McCann  <mccann@jhu.edu>

	* src/gpm-screensaver.c:
	* src/gpm-manager.xml:
	* src/gpm-main.c:
	* src/gpm-idle.c:
	* src/gpm-dbus-common.h:
	* src/gpm-dbus-client.c:
	* src/gpm-console.c (signalhandler_nlost): 
	* docs/www/faq.html: 
	* data/gnome-power-manager.service.in:
	* data/gnome-power-manager.conf:
	Rename DBUS services.  GnomePowerManger -> PowerManager
	and screensaver -> ScreenSaver.  Fixes #326492

2005-01-10  Richard Hughes  <richard@hughsie.com>

	* src/gpm-manager.c: Add some debug text so we know the state.

	* src/gpm-dpms-x11.c (gpm_dpms_mode_from_string): Fix typo where
	"on" should be GPM_DPMS_MODE_ON rather than GPM_DPMS_MODE_OFF.

	* Makefile.am: Use DISTCHECK_CONFIGURE_FLAGS (copied from evince)
	so make diskcheck doesn't try to run scrollkeeper.

	* help/Makefile.am: Enable yelp file build.

	* data/gnome-power-manager.spec.in: Add the two files to the file list.

	* src/gpm-tray-icon.c (gpm_tray_icon_show_help_cb): Now use yelp
	help-pages rather than just displaying the webpage -- note these 
	need serious love.

	* src/gpm-stock-icons.c (gpm_stock_icons_init): Replace 
	GTK_ICON_SIZE_LARGE_TOOLBAR with GTK_ICON_SIZE_MENU as we want the
	smaller icons used in the tray.

	* man/gnome-power-info.sgml: remove as unused.

	NEWS, configure.in: Update to 0.3.4, as I think enough work has been
	done to constitute a release bump. :-)

2006-01-09  William Jon McCann  <mccann@jhu.edu>

	* src/gpm-manager.xml: Mark return string as constant.

	* src/gpm-manager.[ch] (gpm_manager_set_on_ac) 
	(gpm_manager_get_on_ac, gpm_manager_set_dpms_mode) 
	(gpm_manager_get_dpms_mode, hal_on_ac_changed_cb) 
	(gpm_manager_set_property, gpm_manager_init):
	Change functions to actually work with the DBus bindings.

2005-01-09  Richard Hughes  <richard@hughsie.com>

	* configure.in, Makefile.am, help/Makefile.am: Still process the
	help directory, just disable the scrollkeeper update for now.

	* data/gnome-power-manager.spec.in: Don't use this for cvs building
	anymore, so make it generic.

	* docs/dbus-interface.txt: Add this file explaining the DBUS interface.

2006-01-09  William Jon McCann  <mccann@jhu.edu>

	* src/gpm-manager.c (gpm_manager_set_on_ac): Emit a
	signal when on-ac changes.
	(gpm_manager_set_dpms_mode, gpm_manager_get_dpms_mode):
	Add API for DPMS mode.
	(dpms_changed_cb): Emit a signal when DPMS mode changes.
	(gpm_manager_class_init): Add signals.

	* src/gpm-main.c (gpm_object_register): Move here
	from gpm-dbus-server.
	(main): Connect manager to bus.

	* src/gpm-dpms-x11.c (gpm_dpms_mode_from_string) 
	(gpm_dpms_mode_to_string, gpm_dpms_set_mode):
	Add method to translate from enum to string and back.

	* src/Makefile.am: Remove gpm-dbus-server.*
	Rename gnome-power-service.xml to gpm-manager.xml.

	Fixes #326307

2006-01-09  Jaap Haitsma  <jaap@haitsma.org>

	* src/gpm-common.[ch]: Remove unused functions

2005-01-09  Richard Hughes  <richard@hughsie.com>

	* src/gpm-prefs.c (gpm_prefs_create): hide radiobutton_icon_charge
	and radiobutton_icon_critical when we do not have any batteries (as
	these states make no sense).

	* src/gpm-tray-icon.c (libnotify_event): Fix a small typo that
	prevented building with the old libnotify.

2006-01-09  William Jon McCann  <mccann@jhu.edu>

	* src/gpm-tray-icon.c (libnotify_event) 
	(gpm_tray_icon_action_entries): Use #defined icon names.

	* src/gpm-stock-icons.c (gpm_stock_icons_init):
	Add gnome-icon-theme icons to factory.  Add #defines for
	icon names.

2006-01-09  William Jon McCann  <mccann@jhu.edu>

	* src/gpm-dpms.h: 
	* src/gpm-dpms-x11.c: New class to control DPMS.

	* src/gpm-screensaver.[ch]: Remove DPMS stuff.

	* src/gpm-prefs.c (gpm_prefs_create): Don't use
	C99 declarations that aren't at the top of a block since
	it breaks under non-C99 compliant compilers.  Always
	enable DPMS.
	(main): Rename function in case we want to turn it into
	a class later.

	* src/gpm-manager.c (change_power_policy): Don't
	set session timeout.  Sync DPMS settings.
	(sync_dpms_policy): Sync all DPMS settings.
	(idle_changed_cb): Activate/deactivate DPMS.
	(dpms_changed_cb): Throttle screensaver when screen not on.
	(hal_lid_button_cb): Turn monitor power on/off when lid changed.
	(callback_gconf_key_changed): Sync DPMS settings.
	(gpm_manager_init): Add DPMS object.
	(gpm_manager_finalize): Unref DPMS object.

	* src/gpm-idle.c (remove_all_timers, gpm_idle_set_mode) 
	(gpm_idle_set_property, gpm_idle_get_property) 
	(gpm_idle_class_init): Remove session timeout since
	it isn't used and is broken.
	(acquire_screensaver, gpm_idle_init): Break out function.

	* src/Makefile.am: Add gpm-dpms.

	* configure.in: Check for DPMS ext.

	Fixes #326276

2006-01-08  William Jon McCann  <mccann@jhu.edu>

	* src/gpm-tray-icon.[ch]: New class to encapsulate
	tray icon and notification handling.

	* src/gpm-manager.c (get_index_from_percent, get_stock_id) 
	(get_tooltip_system_struct, get_tooltips_system_device) 
	(get_tooltips_system_device_type, get_full_tooltip) 
	(tray_icon_update): Moved here from gpm-notification.c.
	Fix to support GpmTrayIcon.
	(maybe_notify_on_ac_changed, maybe_notify_battery_power_changed):
	Move all notification stuff to tray icon.
	(callback_gconf_key_changed): Update the tray icon.
	(gpm_manager_tray_icon_hibernate, gpm_manager_tray_icon_suspend):
	Add signal handlers.
	(gpm_manager_setup_tray_icon): Create the tray icon.
	(gpm_manager_init): Update/create the tray icon.
	(gpm_manager_finalize): Destroy the tray icon.

	* src/Makefile.am: Remove gpm-libnotify.{c,h} and
	gpm-notification.{c,h}. Add gpm-tray-icon.{c,h}.

	Fixes #326241

2006-01-08  William Jon McCann  <mccann@jhu.edu>

	* src/gpm-manager.[ch]: New class to act as a management
	shell.

	* src/gpm-hal-monitor.[ch]: New class to encapsulate all
	the HAL monitoring.

	* src/gpm-screensaver.h: Add G_BEGIN_DECLS and glib includes.

	* src/gpm-notification.c (callback_actions_activated):
	Disable the actions temporarily until we can use signals
	to do this cleanly.

	* src/gpm-marshal.list: Add new signal for battery
	status changed.

	* src/gpm-main.c: Move functionality out of here and
	split into GpmManager and GpmHalMonitor.

	* src/gpm-idle.[ch]: Turn into a class for monitoring
	the session and system idle.

	* src/gpm-hal.h: Add G_BEGIN_DECLS and glib includes.

	* src/gpm-hal-callback.[ch] (signal_handler_PropertyModified) 
	(signal_handler_DeviceRemoved, signal_handler_NewCapability) 
	(signal_handler_Condition, gpm_hal_callback_init):
	Add user data to be returned to callbacks.

	* src/gpm-dbus-server.[ch]: Don't use gnome.h.  Don't
	export signal enum.
	* src/Makefile.am: Add new files.
	* AUTHORS: Updated.

	Refactored to support handling signals from gnome-screensaver,
	laying groundwork for DPMS management, and making HAL
	optional. Fixes #325911.

2005-01-06  Richard Hughes  <richard@hughsie.com>

	* data/: src/gnome-power-preferences.glade,
	gnome-power-manager.conf, gnome-power-manager.schemas.in,
	gnome-power-manager.service.in, gnome-power-manager.spec.in,
	gnome-power-preferences.desktop.in: Move these files to this new 
	directory to match other gnome projects:

2005-01-05  Richard Hughes  <richard@hughsie.com>

	* gnome-power-manager.schemas.in, src/gpm-main.c, src/gpm-prefs.h:
	Add /notify/fully_charged to fix bug:
	http://bugzilla.gnome.org/show_bug.cgi?id=325876

	* src/Makefile.am: Build the generated files a slightly easier way, as
	suggested by BJÃ¶rn Lindqvist.
	Also comment out the gnome-power-console stuff until the DBUS bug is
	fixed -- as now it's pretty useless.

	* configure.in: Fix the ALL_LINGUAS to be all on one line, else
	autogen.sh fails.

	*configure.in, Makefile.am: Don't build help/ yet as 
	"make distcheck" fails (which means no rpm's)

2006-01-03  Slobodan D. Sredojevic  <ssl@uns.ns.ac.yu>

	* configure.in: Added 'sr' and 'sr@Latn' to ALL_LINGUAS

2006-01-03  Anders Pedersen <anders@zredna.dk>
	
	* src/gpm-notification.c : fixed typo where global variable
	where used instead of passed parametre

2005-12-30  Jaap Haitsma  <jaap@haitsma.org>

	* src/gpm-prefs.c : removed require pw option. We just rely on
	gnome-screensaver for this now

	* src/gpm-prefs.glade : removed require pw option.

2005-12-30  Jaap Haitsma  <jaap@haitsma.org>

	* src/gpm-prefs.c : refactored slider format callbacks
	Added a line that Richard and myself are the authors of this file

2005-12-30  Jaap Haitsma  <jaap@haitsma.org>

	* configure.in : remove -ansi compiler option to fix daemon warning

	* src/gpm-main.c: remove daemon prototype

	* src/gpm-console.c: remove daemon prototype

2005-12-30  Richard Hughes  <richard@hughsie.com>

	* man/: Move manual files here.

	* help/: Add this directory for the yelp help files.

	* configure.in, Makefile.am, docs/Makefile.am: Fix build to work.

2005-12-29  Richard Hughes  <richard@hughsie.com>

	* gnome-power-manager.spec.in: Add "Requires: dbus-x11" to fix
	http://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=176656

	* src/gpm-sysdev.{c|h}, src/gpm-console.c, src/gpm-core.c,
	src/gpm-main.c, src/gpm-notification.c:
	Replace all the SysDev functions with gpm_sysdev_ to closer match
	GNOME CodingStyle.

	* src/gpm-hal.c (gpm_hal_is_on_ac): Fix for the case of a desktop,
	where there is no ac_adapter.

	* src/gpm-screensaver (gpm_screensaver_get_idle): Do a
	s/getIdleTime/getActiveTime to update to the new API.

2005-12-28  Richard Hughes  <richard@hughsie.com>

	* src/gpm-prefs.c, src/gpm-main.c, src/gpm-screensaver.{c|h}:
	Much modified patch from Jaap to use the gnome-screensaver
	screensave enable gconf key, rather than our own complete replacement.

2005-12-26  Jaap Haitsma  <jaap@haitsma.org>

	* src/gpm_marshal.list: rename to gpm-marshal.list
	
	* src/Makefile.am : change gpm_marshal.{c|h} to gpm-marshal.{c|h}

	* src/gpm-dbus-common.c: change gpm_marshal.h to gpm-marshal.h

	* src/gpm-hal-callback.c: change gpm_marshal.h to gpm-marshal.h


2005-12-26  Richard Hughes  <richard@hughsie.com>

	* src/gpm-prefs.c: Patch from Jaap: Suspend is still using battery so
	for a critical level of the battery suspend is not viable option.

2005-12-24  Richard Hughes  <richard@hughsie.com>

	* src/gpm-prefs.c: Don't hardcode acpi_BAT1, but work out the name
	using the capability.

	Another mega patch from Jaap. I've merged the obvious bit for now,
	and when I've reviewed the rest I'll commit that too.

	* Renamed some function like gpm_screensaver_set_dpms to 
	gpm_screensaver_enable_dpms. This way it's immediately clear what the 
	argurment TRUE or FALSE does.

	* Some other renames which should make the code clearer.

	* Fixes a couple of minor bugs

	* Moved some definition from *.h to *.c. It's good practice to export
	as little as possible.

2005-12-23  Richard Hughes  <richard@hughsie.com>

	* src/*: Rename the local dbus_* wrappers gpm_dbus_* to make sure
	it's obvious that they are local functions and not the direct API.

	* gnome-power-manager.conf: Add root to the allowed users. Required
	for replacement without a GUI running.

	* src/gpm-dbus-signal-handler.{c|h}: Add these files to abstract the
	DBUS NameOwnerChanged and NameLost glib functionality.

	* src/glibhal-callback.{c|h}: Remove the NameOwnerChanged bodged
	support from these files. It never belonged here..

	* src/Makefile.am, src/gpm-console.c, src/gpm-dbus-common.c,
	src/gpm-main.c: Use gpm-dbus-signal-handler and start to implement
	NameLost functionality for a shared bus. Also pass more connections
	by reference, rather than assuming then are system or session.

	* src/gpm-hal.c: Move gpm_hal_is_running here, and delete the copy in
	glibhal-main.

	* src/gpm-dbus-common.{c|h}, src/gpm-main.c, src/gpm-dbus-server.c: 
	Make USECACHE an ifdef to try and profile. 
	Also add GPM_SYSTEM_BUS so we can put g-p-m on the system bus if 
	we want, so it can be shared between users. This cannot be turned on 
	until https://bugs.freedesktop.org/show_bug.cgi?id=4637 is fixed.

	* src/gpm-hal.c: Fix valgrinds "Conditional jump or move depends on 
	uninitialised value(s)" by initialising the return value to 0.

	* src/gpm-dbus-common.h, src/glibhal.c, src/glibhal-callback.c,
	src/gpm-hal.c, src/gpm-main.c: Define the HAL_DBUS_* constants and
	use them in preference to hardcoding each name.

	* src/glibhal-main.{c|h}: Merge the remainder of these functions into
	gpm-hal.{c|h} and prefix the functions with gpm_ for clarity.

	* src/glibhal-callback.{c|h}: Move these functions into
	gpm-hal-callback.{c|h} and prefix the functions with gpm_ for clarity.

2005-12-22  Richard Hughes  <richard@hughsie.com>

	* src/gpm-prefs.c: If no valid options are available then disable
	the "Actions" frame as it will be empty.

	* src/gpm-prefs.h, src/gpm-main.c, gnome-power-manager.schemas.in:
	Implement /apps/gnome-power-manager/notify/ac_adapter so we can
	disable this message if we want to. Fixes the bug:
	http://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=176433

	* src/gpm-libnotify.{c|h}, src/gpm-notification.c, src/gpm-main.c:
	Rename the local libnotify_* wrappers gpm_libnotify_* to make sure
	it's obvious that they are local functions and not the direct API.

2005-12-21  Richard Hughes  <richard@hughsie.com>

	* src/gpm-prefs.c: Only hide the battery stuff in the advanced
	tab, and fix to actually hide the correct label in Options.

	* src/gpm-notification.c: Don't g_free eggtrayicon->popup_menu
	or eggtrayicon->tray_icon_tooltip else we segfault on rawhide.

	* src/gpm-main.c: Assume we are on AC power (desktop) if we have
	no batteries or ac_adapters detected. Fixes a problem with g-p-m
	running on a VMWware host thinking we are on batteries.

	* src/gpm-libnotify.c: Use widget->allocation to get size to avoid
	having to ref the pixbuf. Also make lots of libnotify 0.3.x
	fixes. I think notify-daemon has a positioning bug...

	* src/gpm-idle.c: Only print debug messages once.

2005-12-20  Richard Hughes  <richard@hughsie.com>

	* src/gpm-prefs.c: Hide, process, then show the top window so that
	the dialogue resizes itself without redrawing.
	Fixes http://bugzilla.gnome.org/show_bug.cgi?id=323562

	* gnome-power-manager.spec.in: Apply a patch from Matthias Saou to
	fix http://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=172963

2005-12-19  Richard Hughes  <richard@hughsie.com>

	* src/eggtrayicon.c, src/gpm-prefs.c: Update so that if gnome-panel
	disappears we just re-instantiate the icon without crashing.
	Fixes http://bugzilla.gnome.org/show_bug.cgi?id=324446

	* src/gpm-sysdec.{c|h}, gpm-notification.c: Add the sd->isPresent
	flag so we can detect when an sd has no present sds members.
	Fixes http://bugzilla.gnome.org/show_bug.cgi?id=323563

2005-12-19  Nikos Charonitakis  <nikosx@gmail.com>

	* configure.in: Added 'el' to ALL_LINGUAS.

2005-12-19  Ankit Patel  <ankit644@yahoo.com>

        * configure.in: Added 'gu' to ALL_LINGUAS.

2005-12-18  Richard Hughes  <richard@hughsie.com>

	* src/glibhal-extras.{c|h}: Rename to gpm-hal.{c|h} and prefix the
	functions with "gpm_". Affects most of the other souce files!

	* src/gpm-info.{c|h|glade}: Removed until we have a point.

	* src/gpm-gtk-utils.{c|h}: Removed as unused.

	* src/compiler.h: Removed as now unused.

	* configure.in: Make warnings stop build. Fix said warnings.

	* src/gpm-prefs.c: Don't use a pointer like a global variable, else
	it bites back. Use INT_TO_POINTER to wrap it up nicely.

	* src/gpm-hal.c, src/gpm-prefs.c: Add gpm_hal_is_on_ac() so we can get
	rid of the gpm dbus dependance on gpp.

	* configure.in, src/gpm-libnotify.c: Automatically compile the correct
	code for the new libnotify. Thanks again to Jaap.

2005-12-17  Josep Puigdemont i CasamajÃ³  <josep.puigdemont@gmail.com>

	* configure.in: Added 'ca' to ALL_LINGUAS.

2005-12-15  Richard Hughes  <richard@hughsie.com>

	* configure.in: Bump to 0.3.3, and depend on HAL CVS (0.5.6) as we need
	the new power_management keys and the Shutdown() method not present in
	0.5.5.1.

	* src/glibhal-extras.{c|h}, src/gpm-main.c, src/gpm-prefs.h: 
	Create the function hal_shutdown () that lets us simplify the 
	shutdown stuff, and take the magic string out of gconf.

	MASSIVE Patch from Jaap Haitsma <jaap@haitsma.org> with tweaks from me:

	* src/gpm-common.{c|h}: Move get_widget_position to gpm-libnotify.c
	Remove the enumerated types, and conversion functions, and remove 
	the function run_gconf_script()

	* src/compiler.h: Remove as unused.

	* src/gpm-console: Refactor some code, and remove compiler definition.

	* src/gpm-core.c: Refactor some code, remove globals, fix up some
	wrong return values.

	* src/gpm-dbus-common.c: Include <string.h>

	* src/gpm-notification.c: Remove the enumerated types, and conversion
	functions. Other minor warnings fixed.

	* src/gpm-main.{c|h}: Added the constants for gconf.
	Make the policy change more centered. Remove helper functions.

	* src/gpm-networkmanager.c: Removed some unused variables.

	* src/gpm-prefs.glade: Step size update

	* src/gpm-screensaver.{c|h}: Removed some unused variables.
	Added the constants for gconf.

	* src/gpm-sysdev.{h|c}: Mark the debug functions as such, and use the
	debug functions.

2005-12-11  Theppitak Karoonboonyanan  <thep@linux.thai.net>

	* configure.in: Added 'th' (Thai) to ALL_LINGUAS.

2005-12-10  Richard Hughes  <richard@hughsie.com>

	* src/gpm-dbus-common.c: Cache the dbus connection in two private
	pointers so we don't have to keep doing dbus_g_bus_get everytime we
	want the bus address.

2005-12-07  Richard Hughes  <richard@hughsie.com>

	* src/gpm-common.{c|h}, src/gpm-main.c, src/gpm-prefs.c: 
	Remove ACTION_WARNING as nothing uses it. Also make the critical
	warning happen at the critical threshold, and any action performed when
	it gets lower than that. This will stop the PC randomly shutting down
	without giving a critical warning a few minutes before.

	* src/gpm-main.c (gnome_shutdown): Create this function so we can
	save the state interactivly for the case of a power button, or save
	the state non-interactivly for the case of the power-critically-low
	case. Inspired by a patch from Jaap Haitsma <jaap@haitsma.org>.

	* src/gpm-prefs.c, gnome-power-manager.schema.in:
	Remove the options for the power button, as we now display the menu
	(which remembers our state, so we don't need a configurable).
	Patch from Jaap Haitsma <jaap@haitsma.org>, many thanks.

2005-12-03  Richard Hughes  <richard@hughsie.com>

	* src/gpm-common.h, src/gpm-main.c, gnome-power-manager.schemas.in: 
	Remove the reboot command as it's not used, and probably shouldn't be
	part of g-p-m anyway. Taken from a larger patch from 
	Jaap Haitsma <jaap@haitsma.org>.

2005-12-03  Richard Hughes  <richard@hughsie.com>

	* src/glibhal-extras.c: Now upstream HAL is using the new 
	power_management.* keys, we should not be checking .is_enabled as this
	has been removed in CVS.

	* src/gpm-common.c (get_timestring_from_minutes): Use ngettext to get
	plural form. Based on a patch from Gabor Kelemen, many thanks.
	Fixes bug http://bugzilla.gnome.org/show_bug.cgi?id=322773

	* src/gpm-main.c: Add in the virtual buttons Hibernate, Suspend and
	Lock.

	* src/gpm-screenaver.c: Do not expect a DBUS answer when we lock or
	poke as we have to wait for the dbus connection to time out.

	* src/gpm-main.c: Replace use of get_time_string with the data itself.
	Fixes bug: http://bugzilla.gnome.org/show_bug.cgi?id=323135

	* src/gpm-common.c (get_time_string): Remove this function as it is
	no longer in use.

2005-12-01  Richard Hughes  <richard@hughsie.com>

	* configure.in: Bump to 0.3.2

	* src/glibhal-extras.{h|c}: Move hal_pm_check() here, and create the
	new methods hal_pm_can_suspend() and hal_pm_can_hibernate().
	Also add hal_set_brightness_up() and hal_set_brightness_down () so
	we can start to play around with new HAL stuff.

	* src/gpm-main.c: Warn if we attempt to hibernate or suspend when HAL
	says we shouldn't.

	* src/gpm-main.c: Add support for the HAL "virtual button" device.
	NB. This is not yet in HAL CVS, and support is patched in only if you
	use the RPM's in my utopia-experimental repo. The interface WILL change
	before it is accepted upstream.

	* src/gpm-notification.c: Don't add the menu items if we can't do the
	actions. NOTE: just because HAL (i.e. the kernel) says it has
	hibernation or suspend support compiled in, doesn't automatically
	mean that it will *work*.

	* src/gpm-prefs.c: Don't show the options if we can't do the action.
	Also make the whitespace a bit more sane in this file.

	* src/gpm-prefs.c: Don't try to free a constant if schema missing.
	Fixes bug: https://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=174196

2005-11-28  Richard Hughes  <richard@hughsie.com>

	* src/gpm-notification.c (gpn_icon_update): Don't try to free a
	constant, i.e. use g_strdup so we unconditionally free the string.
	This bug only appears when the gconf schema isn't being applied,
	which is probably a packaging bug.

2005-11-28  Ignacio Casal Quinteiro  <nacho.resa@gmail.com>

	* configure.in: Added 'gl' to ALL_LINGUAS.

2005-11-27  Richard Hughes  <richard@hughsie.com>

	* src/gpm-main.c (perform_power_policy): Create this new function
	so we can put all the common code together. This also lets us sets
	all the settings in one place, so we can now do every power saving
	action simply when we are booted from battery. This fixes the bug where
	the brightness wasn't being set on boot.

	* src/gpm-main.c (perform_sleep_methods): Put all the common code in
	one place so we can set the password resume policy in one place.

	* gnome-power-manager.schemas.in: Add general/require_password to
	signify if we require a password when resuming from suspend.

	* src/gpm-prefs.c, src/gpm-prefs.glade:
	Add the required widgets to control "general/require_password"

	* configure.in: Bump HAL dep to 0.5.4 as using 0.5.3 doesn't work
	correctly with Ubuntu breezy HAL, which is causing lots of bug reports.

	* gnome-power-manager.spec.in: Remove the prefix line as it's not
	correct, and the rpm builds fine without it.

	* src/gpm-notification.h, src/gpm-notification.c:
	Fix the problem where the About window's content is not localizable.
	Apply a patch from Gabor Kelemen that makes it localizable.
	Fixes http://bugzilla.gnome.org/show_bug.cgi?id=322547

2005-11-26  Marcel Telka  <marcel@telka.sk>

	* configure.in (ALL_LINGUAS): Added sk.

2005-11-26  Richard Hughes  <richard@hughsie.com>

	* gnome-power-manager.schemas.in:
	Default to suspend on lid close on advice of Havoc Pennington, to
	address bug https://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=174160
	Also make /apps/gnome-power-manager/policy/sleep_type to type suspend
	as nothing is no longer a valid option.

	* configure.in:
	Bump to 0.3.1

	* src/gpm-notification.c:
	Disable 'Power Info' from the menu until we show something interesting.

	* gnome-power-preferences.desktop.in:
	Rename "Power Preferences" to "Power Management" to better fit in with
	the other menu items.

2005-11-21  Richard Hughes  <richard@hughsie.com>

	* src/gpm-prefs.c, src/gpm-prefs.glade:
	Merge a patch by Jaap Haitsma <jaap@haitsma.org>:
	- Changed vertical spacing between some items in dialog from 4 to 6 
	pixels (HIG says it should be 6)
	- All capplets have the dialog hint set for the window so they don't 
	have a minimize button.
	- Removed the setting from the icon from the glade file to the C file. 

2005-11-21  Richard Hughes  <richard@hughsie.com>

	* src/gpm-prefs.c, src/gpm-prefs.glade:
	Merge a patch by Jaap Haitsma <jaap@haitsma.org>:
	Split the General section in the options Tab to two sections: 
	General and Actions. Tweaked by me.
	Furthermore it changes accesskeys of some labels to more sensible keys.
	Also remove the gnome-screensaver button now g-p-m is less tied into
	g-s with the DPMS settings.

	* src/gpm-core.{c|h}:
	Add the core, abstracted interfaces so we can use them with a console
	program. Taken from gpm-main.c.

	* src/gpm-console.c:
	Add the beginning of a console g-p-m for GDM.

	* src/gpm-common.{c|h}:
	Re-organise with the console muddle.

	* src/gpm-idle.c, src/gpm-info.c, src/gpm-main.c,
	src/gpm-screensaver.{c|h}:
	s/gscreensaver_/gpm_screensaver/g for consistancy.
	Also add gpm_screensaver_poke so we can interrupt the screensaver
	instead of waiting for a keypress.

2005-11-17  Richard Hughes  <richard@hughsie.com>

	* src/gpm-networkmanager.{c|h}:
	Add methods to call NetworkManager to tell it to sleep or wake during
	the suspend/resume calls. This isn't connected into the build yet
	as we have to solve 3 sec timeout problem when NM isn't running.

	* src/glibhal-extras.c:
	If the manufacturer is IBM, then assume we are a ThinkPad,
	and don't do the new-fangled dimming routine. The ThinkPad dims
	gently itself. This fixes the bug:
	http://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=173382

	* src/gpm-dbus-common.{c|h}:
	Add dbus_is_active_service so we can print and search the services
	on the system bus.

	* src/gpm-screensaver.{c|h}, src/gpm-prefs.c, src/gpm-idle.c:
	First, do s\gscreensaver_\gpm_screensaver_\g to be consistant.
	Also add gpm_screensaver_poke() to allow us to "poke" g-s so we can
	displays the unlock dialogue, so the user doesn't have to move the
	mouse or press any key.

2005-11-15  Richard Hughes  <richard@hughsie.com>

	* src/gpm-main.c, src/gpm-info.c, src/gpm-prefs.c, src/gpm-prefs.glade,
	src/icons/Makefile.am: 
	Merge a patch by Jaap Haitsma <jaap@haitsma.org>:
	- "Never" on the right of the sleep sliders
	- Sleep sliders range from 1 to 60 minutes with steps of 1 minute
	- In Makefiles GPM_DATA had a trailing slash. This is not common.
	- Some code refactoring: There was now one callback handling all the 
	different sliders. Since there are three types of sliders:
	1. Setting sleep time
	2. Setting disply brightness
	3. The low and critical threshold
	That callback became quite messy. So instead of 1 difficult to 
	understand I made 3 of them which should be quite easy to understand.

	* src/gpm-notification.c: display the charged icon whenever we are
	not discharging and not charging as opposed to when at 100% as some
	batteries will never get to the maximum value.
	Should fix http://bugzilla.gnome.org/show_bug.cgi?id=321034

2005-11-14  Richard Hughes  <richard@hughsie.com>

	* src/gpm-main.c, src/gpm-prefs.c: 
	Merge a patch by Jaap Haitsma <jaap@haitsma.org>:
	- Make gpm use the standard gnome way to do command line parsing
	(using popt).
	- Furthermore after a gnome_program_init there is no need to do a 
	gtk_init, g_type_init etc. because gnome_program_init already does this.
	- Also, gpm-prefs did not have the standard calls to bindtextdomain etc.

2005-11-13  Richard Hughes  <richard@hughsie.com>

	* src/gpm-screensaver.{c|h}: Add gscreensaver_set_dpms() to solve the
	case where the laptop backlight isn't being turned off when the
	lid goes down. For the time being, we'll use the hack that is xset,
	but when (if?) gnome-screensaver supports a DBUS method we'll switch
	to that. Should solve http://bugzilla.gnome.org/show_bug.cgi?id=321313

	* src/gpm-main.c: Use gscreensaver_set_dpms on the lid events.

	* po/nl.po: Updated, thanks Theetjuh.

	* src/Makefile.am: Add the extra director defines.

2005-11-10  Richard Hughes  <richard@hughsie.com>

	* src/gpm-sysdev.c: Create a helper function sysDevGetIndex so we don't
	have to bounds check every request, and cast in every call.

	* src/icons/gnome-power-ac-charged.png,	src/gpm-notification.c,
	src/gpm-stock-icons.{c|h}:
	Remove the charging symbol when the battery is at 100% and not charging.

	* docs/www/packages.html: Add info about running HAL as root in breezy.

2005-11-10  Richard Hughes  <richard@hughsie.com>

	* src/gpm-notification.h: Give credit to the translators.

	* src/gpm-main.c, gpm-sysdev.c: Rearrange the icon processing so it's
	done *after* the sysdev update.

2005-11-10  Alexander Shopov  <ash@contact.bg>

	* configure.in: Added "bg" (Bulgarian) to ALL_LINGUAS

2005-11-10  Fabio Marzocca  <thesaltydog@gmail.com>

	* po/ChangeLog:
	* po/it.po:

	Updated italian translation

2005-11-10  Ilkka Tuohela  <hile@iki.fi>

	* configure.in: Added Finnish (fi) to ALL_LINGUAS.

2005-11-10  Satoru SATOH <ss@gnome.gr.jp>

	* configure.in: Added Japanese (ja) to ALL_LINGUAS.

2005-11-10  Å½ygimantas BeruÄka  <zygis@gnome.org>

	* configure.in: Added Lithuanian to ALL_LINGUAS.

2005-11-09  Richard Hughes  <richard@hughsie.com>

	* po/: Update all the po files with the latest translations.

	* src/gpm-sysdev.c (sysDevUpdate): The ac_adapter charging thing was
	causing more trouble than it's worth...

2005-11-08  Richard Hughes  <richard@hughsie.com>

	* src/gpm-main.c, src/gpm-libnotify.{c|h}:
	Clear the libnotify box for where we add back the ac_adapter before
	the "AC Power unplugged" message times out.

	* src/gpm-notification.c, src/gpm-main.c, src/gpm-prefs.glade,
	gpm-common.{c|h}, gpm-prefs.c:
	Make the notification icons into radio boxes and make the options sane.

2005-11-07  Richard Hughes  <richard@hughsie.com>

	* src/gpm-sysdev.c: Shortcut for the single battery case so we don't
	average over 1 each time. Might save a few CPU cycles.
	Also try to start to fix:
	https://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=169158
	by multiplying the remainingTime by the number of devices present
	if one battery is discharging and others not. This assumes they have
	the same capacity, and needs to be fixed properly.

	* src/gpm-main.c: Don't use sysDevUpdateAll when we have the UDI and
	can work out the system device to do a specific sysDevUpdate.
	This should make g-p-m less processor hungry.

2005-11-06  Richard Hughes  <richard@hughsie.com>

	* src/gpm-notification.c, src/gpm-sysdev.c:
	Do not segfault when battery bay is empty, and only add present
	batteries to the calculations.
	Fixes http://bugzilla.gnome.org/show_bug.cgi?id=320658

	* src/gpm-notification.c: Check for discharging and charging instead
	of checking for 100%.
	Should fix http://bugzilla.gnome.org/show_bug.cgi?id=320836

	* src/gpm-sysdev.{c|h}, src/gpm-main.c: Add sd link to parent so we
	can find our device type. Update the correct battery type, not just
	BATT_PRIMARY on HAL event.

	* src/gpm-notification.c: Do not leak eggtrayicon by just hiding it,
	but properly unrealize it. This fixes the bug where the icon "moved"
	across the notification area when it was repeatedly shown/hidden.

	* src/gpm-sysdev.{c|h}, gpm-main.c (hal_device_property_modified):
	Check that the battery is at 100%, AND of type "primary" before
	notifying the user that their battery is charged :-)

2005-11-05  Richard Hughes  <richard@hughsie.com>

	* configure.in: Change libwnck dep to 2.10.0. Not sure what happened
	with that... Update version 0.2.10 as I have made MASSIVE changes
	to the internals of g-p-m.

	* src/gpm-sysdev.{c|h}: New files to abstract away the multiple device
	problem. We are not using the shitty slotData and VirtualType system
	anymore as it is not flexible and it not understandable.
	Imagine ripping out the Ford Fiesta engine and replacing it with a
	Ferrarri engine and you get the idea of the changes...
	This will let us support multi-batteries *much* better.

	* src/gpm-common.{c|h}: Rip out the old device structures and functions.
	This makes hughsie happy.

	* src/gpm-notification.c: Now we show the icons if low, or if we want
	to overrride for the primary battery. Anything else is crack.

	* src/gpm-libnotify.c: Now make all notifications replace the former,
	to stop notifications from piling up the screen. Also point to the
	bottom middle part of the icon, not the top left most point.

	* src/gpm-dbus-server.c, gpm-main.c: Replace use of statedata
	with onAcPower.

	* src/gpm-prefs.glade, gnome-power-manager.schemas.in, src/gpm-prefs.c:
	Remove the configurable option for ac_adapter removal
	(warning hardcoded). Also remove the Always Display textbox.

2005-11-01  Richard Hughes  <richard@hughsie.com>

	* configure.in: Bump to 0.2.9.2 as we have lots of new stuff to test.

	* src/gpm-notification.c: Replace create_icon_pixbuf () with
	get_stock_id_for_slot_data so we can use the new stock icons.

	* src/gpm-stock-icons.{c|h}: Add the extra icons.

	* src/gpm-common.{c|h}: Remove gpm_set_icon_with_theme () and
	gpm_icon_theme_fallback () as Jaap has provided a proper framework for
	us to use.

	* src/icons/*.png: Refactor icons to 24x24 to keep the HIG people happy
	and also so we can use the stock icons functionality.

	* src/icons/Makefile.am: Add new files gnome-power-mouse.png and
	gnome-power-keyboard.png as we will use these files soon for low
	device warning.

2005-10-31  Christopher Aillon  <caillon@redhat.com>

	* src/gpm-common.c:
	* src/gpm-common.h:
	Signature of get_time_string () and get_timestring_from_minutes ()
	now return gchar* instead of GString*
	Also, handle the case when we have multiple hours but only 1 minute
	and use commas to separate the units.

	* src/gpm-main.c:
	* src/gpm-notification.c:
	* src/gpm-prefs.c:
	Use gchar* instead of GString* for calls to get_time_string ()
	and get_timestring_from_minutes ()

2005-10-31  Richard Hughes  <richard@hughsie.com>

	* configure.in: Spring clean this file so it's readable.

	* CodingStyle: Update.

	* gnome-power-manager.spec.in: Use the dep values from autoconf.

	* gnome-power-manager.sgml,
	* gnome-power-preferences.sgml,
	* gnome-power-info.sgml: Move to docs/man/

2005-10-31  Dennis Cranston  <dennis_cranston@yahoo.com>

	* src/gpm-prefs.glade:  GNOME HIG fixes (spacing, mnemonics,
	and capitalization)

2005-10-31  Richard Hughes  <richard@hughsie.com>

	* src/gpm-main.c (main): Disable GNOME_RESTART_IMMEDIATELY as a couple
	of users are getting constant crashes that they can't kill.

2005-10-30  Richard Hughes  <richard@hughsie.com>

	* src/gpm-notification.c,
	* src/gpm-main.c,
	* src/gpm-common.h,
	* README,
	* gnome-power-manager.spec.in,
	* gnome-power-manager.sgml,
	* gnome-power-preferences.sgml,
	* gnome-power-info.sgml,
	* doc/www/*:
	s/gnome-power.sf.net/http://www.gnome.org/projects/gnome-power-manager/

2005-10-30  Richard Hughes  <richard@hughsie.com>

	* Configure.in: Default to off for doxygen documentation as most users
	do not need these (and this saves us time for each compile).
	Also bump to 0.2.9, as we are introducing new functionality.

	* src/gpm-notification.c: Fix up the menu to be more in line with
	GNOME HIG. Thanks to Jaap Haitsma <jaap@haitsma.org> for the patch.

	* src/gpm-main.c: remove the last bits of the "registered" gslist.
	Also invalidate the remaining time on battery.rechargeable.is_charging
	as we need to wait for the next HAL update. This is a HAL bug I think.

	* src/gpm-prefs.c: Use gtk_image_set_from_icon_name rather than
	our inbuilt functions.

	* src/gpm-stock-icons.{c|h}: This is the start for generic stock
	icons functionality. At the moment it just adds the ac_adapter icon,
	but it's expected to work for all the other icons too.
	Initial patch by Jaap Haitsma.

	* src/icons/: Move gnome-dev-acadapter.png and gnome-power.png here.

	* src/pixmaps/: Remove this directory as it is now not required.

2005-10-29  Christopher Aillon  <caillon@redhat.com>

	* src/gpm-libnotify.c:
	* src/gpm-libnotify.h:
	(libnotify_event) Add a new argument for setting the
	primary text of a notify event, and use it for calls to
	libnotify and its GtkMessageDialog fallback.

	* src/gpm-main.c:
	* src/gpm-prefs.c:
	Send descriptive primary text with libnotify_event () calls.

2005-10-29  Richard Hughes  <richard@hughsie.com>

	* gpm-notification.c (get_object_tooltip): Do not display
	"Unknown remaining" for missing remaining time.
	Fixes http://bugzilla.gnome.org/show_bug.cgi?id=320135

	* src/icons/gnome-power-keyboard.png,
	src/icons/gnome-power-mouse.png: New icons from Diana Fong to convey
	a low power USB mouse and keyboard. Many thanks!

	* docs/www: Update to the new HTML website design, in prep for moving
	to gnome.org hosting.

2005-10-27  Richard Hughes  <richard@hughsie.com>

	* docs/www/report_bug.php, src/gpm-main.c (main): don't ask people to
	report bugs directly to me, but use bugzilla.

2005-10-27  JP Rosevear  <jpr@novell.com>

	* src/gpm-dbus-server.c (gpm_object_register): don't assert for
	things not related to our internal state
	
	* src/gpm-prefs.c (callback_gconf_key_changed): ditto
	(callback_combo_changed): ditto
	(callback_hscale_changed): ditto
	(callback_check_changed): ditto
	(format_value_callback_percent): ditto
	(format_value_callback_percent_lcd): ditto
	(format_value_callback_time): ditto

	* src/gpm-notification.c (callback_actions_activated): ditto
	(tray_icon_release): ditto
	(tray_icon_press): ditto

2005-10-26  JP Rosevear  <jpr@novell.com>
	
	* src/gpm-main.c (callback_gconf_key_changed): don't assert for
	things not related to our internal state

	* src/gpm-notification.c (create_icon_pixbuf): do not assert
	before freeing, g_free handles null pointers

	* src/gpm-main.c (get_policy_string): ditto
	(gpm_exit): ditto
	(add_battery): ditto
	(hal_device_condition): ditto

	* src/glibhal-main.c (is_hald_running): ditto
	(hal_free_capability): ditto
	(hal_num_devices_of_capability_with_value): ditto

	* src/glibhal-callback.c (glibhal_watch_remove_device_property_modified): ditto
	(glibhal_watch_remove_device_condition): ditto

2005-10-26  JP Rosevear  <jpr@jprosevear.org>

	* src/pixmaps/Makefile.am: ditto

	* src/icons/Makefile.am: ditto

	* src/Makefile.am: ditto

	* docs/Makefile.am: don't explicitly clean Makefile and
	Makefile.in

	* Makefile.am: remove extraneous tab; don't dist autogen,
	configure is all you need; don't dist mkinstalldirs, thats done
	automatically; don't explicitly clean Makefile and Makefile.in and
	other automatically handled files

2005-10-26  Richard Hughes  <richard@hughsie.com>

	* docs/www/dbus_interface.php, src/gpm-dbus-server.{c|h},
	src/gnome-power-service.xml: Make the DBUS interface much simpler.

	* src/gpm-dbus-test.c, src/Makefile.am: Remove gpm-dbus-test as part
	of making the interface simpler.

	* src/gpm-common.{c|h}, src/gpm-main.c: Remove some obsolete code.

	* configure.in: Bump to 0.2.8.2

	* src/gpm-notification.c: Add patch from Jaap Haitsma
	<jaap@haitsma.org> so that the menu just shows below/above the
	top/bottom panel.

2005-10-25  Richard Hughes  <richard@hughsie.com>

	* src/gpm-prefs.glade: Remove trailing dot from checkboxes to confirm
	to GNOME HIG. Spotted by Mark Rosenstand <mark@borkware.net>, thanks.

	* src/gpm-prefs.c (combo_setup_dynamic) : Don't leak policyoption.

2005-10-24  Richard Hughes  <richard@hughsie.com>

	* Makefile: Ship autogen.sh

	* gnome-power-info.sgml: Add this file to keep the ubuntu build quiet.

	* configure.in: Change hal dep from 0.5.4 to 0.5.3 so we can build on
	ubuntu breezy. 0.5.3 will work with g-p-m, but there are lots of bugs
	in 0.5.3 fixed in later releases.
	Also bump to 0.2.8.1, and release.

	* src/gpm-info.glade : Don't hide this window, make it "normal" like
	the others.

	* src/gpm-main.c (main) : Register the name of the application rather
	than something random (to the session-manager).
	Patch from Matthew Garrett <mjg59@srcf.ucam.org>

	* Makefile.am: Delete the Makefile.in's in MAINTAINERCLEAN rather
	than DISTCLEAN so we can build on ubuntu.

2005-10-22  Christopher Aillon  <caillon@redhat.com>

	* src/gpm-libnotify.c:
	Use GtkMessageDialog instead of GnomeMessageBox since the former
	supports PangoMarkup and the latter is deprecated.

2005-10-20  Richard Hughes  <richard@hughsie.com>

	* src/gpm-main.c, gpm-common.c: Fix a NULL pointer dereference where
	the remaining_time isn't known, and the battery is low.
	Also don't crash when we do not have gnome-dev-memory in our theme.
	Reported by Andrey Tuev, thanks!

2005-10-17  Richard Hughes  <richard@hughsie.com>

	* src/*.c: Lots of doxygen additions and cleanups.

2005-10-15  Richard Hughes  <richard@hughsie.com>

	* po/POTFILES.in: Added the new translatable files. Lots more stuff
	to translate, sorry! (but I *really* appreciate your work...)

	* src/gpm-main.c, src/glibhal-callback.{c|h}: Added the
	NameOwnerChanges callback infrastructure, so we can now detect when
	HAL disappears from the system bus.

2005-10-12  Robert Love  <rml@novell.com>

	* src/gpm-info.c: Fix various compiler warnings.

2005-10-10  Richard Hughes  <richard@hughsie.com>

	* src/gpm-common.c, src/gpm-main.c: Little tidy-ups.
	Moved the functions gpm_set_icon_with_theme () and
	gpm_icon_theme_fallback () here from gpm-notification.c

	* src/gpm-prefs.c, src/gpm-prefs.glade: Adds the estimated time
	property to the slider widgets. Add themed icons for Rodrigo Moya.

2005-10-06  Richard Hughes  <richard@hughsie.com>

	* src/gpm-gtk-utils.{c|h} (gpm_gtk_set_sensitive): Add new function
	to let us quickly set widget sensitivity.

	* src/gpm-prefs.c, src-gpm-main.c, gnome-power-schemas.in,
	src/gpm-prefs.glade, src/gpm-notification.c: Add the new
	display_icon_others functionality so we can support desktops with
	wireless mice. This is turned off by default.

2005-10-06  Richard Hughes  <richard@hughsie.com>

	* src/gpm-main.c (read_battery_data): Try to get an debug report if
	we are missing battery.remaining_time or
	battery.charge_level.percentage.
	Also add a newline after the version string -- patch thanks to
	Wouter Bolsterlee <uws+gnome@xs4all.nl>

	* src/gpm-notificiation.c (get_notification_icon): Check before
	dereferencing eggtrayicon.

	* src/pixmaps/stock_about.png, src/pixmaps/stock_notebook.png
	src/pixmaps/stock-properties.png, src/pixmaps/Makefile.am: Add default
	fallbacks as not present on debian.

2005-10-04  Richard Hughes  <richard@hughsie.com>

	* src/gpm-dbus-client.{c|h}: Abstract this away from gpm-prefs.c

	* src/gpm-gtk-utils.{c|h}: Abstract this away from gpm-prefs.c

	* src/gpm-prefs.c: Make lots smaller :-) This is in prep for another
	program, g-p-i.

	* src/gpm-info.c: The start of another program, GNOME Power Info

	* src/Makefile.am: Add these extra files, and add gnome-power-info
	to the built files.

	* src/dbus-common.{c|h}: Rename to gpm-dbus-common.{c|h}

2005-10-04  Rodrigo Moya <rodrigo@novell.com>

	* src/gpm-main.c (hal_device_property_modified): display a notification
	when the battery is fully charged.

2005-10-04  Richard Hughes  <richard@hughsie.com>

	* configure.in: Update docs and remove sounds.

	* src/sounds: Remove.

	* src/icons, src/gpm-notification.c: Rename icons to better suit gpm.

	* src/preferences.glade: Remove

	* src/gpm-prefs.glade, src/gpm-info.glade: Add these new files.
	I've split the information stuff into it's own glade file as requested
	by Robert Love.

	* src/compiler.h: Add this file to hold all the GCC4 check ifdefs.

	* src/gpm-prefs.c, src/Makefile.am: Update glade file reference.
	Remove the information page refresher stuff and move to gpm-info.c

	* src/gpm-notification.c: Use run_bin_program to lauch (all) our
	external programs.
	Also coalesce all the custom functions in (menu_main_create) to use
	just menu_add_action_item (which lets us group the callbacks too)
	Also fix so the seporator is shown...

	* src/gpm-common.{c|h}: Add run_bin_program to allow us to run
	g-p-p and the new g-p-i (to come... :-) programs.

	* doc/*: Update so www has it's own directory, and move down html into
	a lower level doxygen directory.

2005-10-02  Richard Hughes  <richard@hughsie.com>

	* configure.in: Bump to 0.2.7. Add in Doxygen configure logic.

	* docs/code: New directory for the Doxygen generated pages

	* docs/Makefile.am, docs/.cvsignore: Add these files so we can
	build ./code.

	* docs/code/Makefile.am, docs/code/Doxygen.in: Add Doxygen build files.

	* src/*.c, src/*.h: Add Doxygen comments. Phew!

2005-10-02  Richard Hughes  <richard@hughsie.com>

	* configure.in: Bump to 0.2.6.1

	* src/gpm-idle.c (gpm_idle_update): Don't return FALSE is timeout is
	set to zero, as the polling will stop. The polling needs to continue
	in case the value is changed in g-conf.

	* src/gpm-notification.c (gtk_icon_theme_fallback): Do the icon
	fallback is a more robust way (so sizes are unimportant).
	(create_icon_pixbuf): Return the pixmap for type POWER_AC_ADAPTER.
	Fixes problems reported by Dumitru Ciobarcianu.

2005-10-01  Richard Hughes  <richard@hughsie.com>

	* src/gpm-idle.c (update_idle_function): Actually print the return
	value of gscreensaver_get_idle ();
	Also check the value of the timeout to check it's not set to zero.

	* src/gpm-notification.c: Moved callback_gconf_key_changed () to
	src/gpm-main.c so we can do clever stuff. Not sure why it was ever in
	this file in the first place...

	* src/gpm-main.c: Fix two typos in the gconf keys threshold_low and
	threshold_critical, and one thinko in the order of calculating the
	old and new charges. The warnings and auto-action should now work
	again now. Found as a co-incidence of running out of battery power...
	(callback_gconf_key_changed): Add case where g-p-p should force an
	update to dmps_suspend without having to change state.
	Reported by Theetjuh <theetjuh@gmail.com>.

	* src/gpm-main.c, src/gpm-idle.c: Add in the full idle functionality,
	so that we can either suspend or hibernate when we are deemed idle.

	* src/gpm-screensaver.c: setThrottleEnabled now doesn't return us a value.
	Fix our calling function to also return the value of getIdleTime,
	rather than just the success.

	* docs/gnome_power_manager.php, docs/gnome_power_preferences.php:
	Add a couple of new images and update the text a bit.

	* src/glibhal-extras.c: Return a success value, and pass in steps by
	reference.

	* src/gpm-prefs.c: make sure hscale_batteries_display and
	hscale_ac_display are set to 5 minute divisions.
	Also, only set the LCD slider points if we have LCD hardware.
	This removes a warning on desktop systems.

2005-09-30  Richard Hughes  <richard@hughsie.com>

	* configure.in: Bump to 0.2.5.4

	* src/gpm-common.c (get_widget_position): new function to get center
	point of a widget.

	* src/gpm-libnotify.c: Added back (in a better way) the
	libnotify-points-to-icon feature.

	* src/gpm-prefs.c: Turn on DPMS if not enabled at start.

	* src/gpm-screensaver.c: Attempt to get return val right.

	* src/gpm-idle.c: Do not continue to poll gnome-screensaver if the
	first call failed. This will avoid a warning every minute.

	* src/gpm-main.c, src/gpm-notification.c: Use the new libnotify
	widget centering functionality.

	* src/*.c: Use new the macros G_GNUC_WARNUNCHECKED for a few vital
	functions (where we MUST check the return value), and then fix up
	all my sloppy programming...

2005-09-29  Richard Hughes  <richard@hughsie.com>

	* configure.in: Bump to 0.2.5.3

	* src/glibhal-extras.c (hal_is_laptop): Factor out this code into it's
	own function so we can use it in a different way...

	* src/gpm-prefs.c (gtk_set_label): Make a simple wrapper...

	* src/gpm-prefs.c (refresh_info_page) Make a function to populate the
	new "Information" tab present in the glade file.

	* src/preferences.glade: Add the new "Information" tab with system
	information. This is all very immature, and likely to change.

	* src/gpm-prefs.c (combo_setup_dynamic),
	src/gpm-main.c (get_policy_string): Make sure we check for a null
	gconf return string. This was reported by Myk Melez <myk@mozilla.org>
	where the gconf schema installation was incorrect. This means we
	shouldn't trigger the assert in gpm_common.c (convert_string_to_policy).

2005-09-28  Richard Hughes  <richard@hughsie.com>

	* src/gpm-libnotify.{c|h}: Factor out the notification stuff into
	these two new files.

	* src/gpm-prefs.c, src/gpm-prefs.c: use the new libnotify stuff and
	delete the local functions which do the same thing.
	Also fix desktops that do not have an LCD panel. Oops.

	* src/*.{c|h}: I've audited these files and added complete NULL
	dereference assert checks, and made sure *all* local pointers are
	always setup with deault value NULL. This may break stuff, but will
	make debugging easier.

	* src/gpm-notification.c (callback_about_activated): Use the
	gtk_about_dialog functionality instead of replying on depreciated
	functionality. Also add GNU licence and the translators.

2005-09-26  Robert Love  <rml@novell.com>

	* src/gpm-main.c: Daemonize by default, via daemon(3).  Add
	  "--no-daemon" flag.

2005-09-26  Richard Hughes  <richard@hughsie.com>

	* src/gpm-prefs.c, src/gpm-idle.c, src/gpm-screensaver.{c|h},
	src/glibhal-extras.c, .cvsignore, src/Makefile.am: Fix build warnings.
	Patch from Robert Love <rml@novell.com>, Many thanks.

	* src/configure.in: Apply many fixes from Robert Love, many thanks.

2005-09-26  Richard Hughes  <richard@hughsie.com>

	* gnome-power-manager.spec.in: Now kill gconfd-2 on update to force
	schema, and use @VERSION@ to make my life easier.

	* docs/compile.php, docs/faq.php: Add new information

	* src/glibhal-extras.c (hal_get_brightness_item): New function, to
	get the LCD brightness value.
	(hal_set_brightness_dim): New function, allows us to dim the screen
	slowly, rather than one big jump.
	We now support ONLY the new SetBrightness HAL API in HAL CVS.
	http://article.gmane.org/gmane.comp.freedesktop.hal/3280

	* src/gpm-notification.c: Remove some #if 0 stuff.

	* src/gpm-prefs.c: make the new functionality of format_value_callback_percent_lcd () so the slider can step only to allowed values.

	* src/preferences.glade: Make percentages have no decimal points.

	* src/gpm-main.c: Use the hal_set_brightness_dim functionality.

	* configure.in: Bump to 0.2.5.1

2005-09-22  Rodrigo Moya <rodrigo@novell.com>

	* src/gpm-prefs.c:
	* src/glibhal-extras.c: added missing string.h for 64bit compilation.

	* src/gpm-notification.c (callback_about_activated): fixed 64bit
	warning.

2005-09-21  Richard Hughes  <richard@hughsie.com>

	* src/gpm-prefs.c (main): Actually make gnome-screensaver detection
	work, and tie the sliders into divisions of 5 minutes.

	* gnome-power-manager.spec.in: Add dep on gnome-screensaver
	Also fix the directory owning problem, where we couldn't access our
	shared files on some machines.
	Reported by Ben Liblit <liblit@cs.wisc.edu> -- Thanks.

	* configure.in: Bump to 0.2.5 (odd = unstable).

2005-09-21  Richard Hughes  <richard@hughsie.com>

	* src/gpm-common.{c|h}: remove unused function
	convert_powerdevice_to_gnomeicon.

	* src/gpm-notification.c: remove the LCD sub menu as the icons have
	now gone. This belongs in an applet, if at all.

	* gnome-power-manager.spec.in: Add back the libnotify stuff as we are
	not building locally for redhat, and we provide libnotify rpm's.

	* configure.in: Bump to 0.2.4.

2005-09-21  Rodrigo Moya <rodrigo@novell.com>

	* src/gpm-main.c: include dbus-glib-lowlevel for
	dbus_g_connection_get_connection for clean 64bit compilation.

2005-09-20  Richard Hughes  <richard@hughsie.com>

	* src/glibhal-extras.c (hal_setlowpowermode): Only call SetPowerSave
	if system.formfactor is "laptop". Patch pending for PMU for HAL.

	* src/gpm-prefs.c: Remove all the GSCREENSAVER #ifdefs and switch to
	runtime detection of the dbus service.

	* configure.in: Remove detection for gnome-screensaver as we now do
	this at runtime.

	* src/Makefile.am: Add gpm-screensaver.{c|h} to gnome_power_preferences.

	* src/gpm-screensaver.{c|h}: Add funtion gscreensaver_is_running ().

2005-09-13  Richard Hughes  <richard@hughsie.com>

	* configure.in: bump to 0.2.3.2
	Also add the command line --enable-glibhal to try out the new code.

	* gnome-power-manager.spec.in: Updated with davidz's (redhat) changes.

	* docs/contact.php : Add Matthias Grimm, and Matthew Garrett to the
	credits - thanks guys!

	* docs/faq.php: Add "Why do events take so long to register?"

	* docs/gnome_power_manager.php : Move content from index.

	* docs/index.php: Add content from Matthias Grimm.

	* src/gpm-screensaver.{c|h}: New files for the GNOME Screensaver stuff.

	* src/gpm-idle.{c|h}: New files for the idle calculation stuff.

	* src/Makefile.am : Add these new files to gnome_power_manager

	* src/glibhal-* : Some tidying up, and wightspace fixes.

	* src/glibhal-main.{c|h} : Add is_hald_running (), hal_pm_check ().

	* src/gpm-main.c : Add calls to gscreensaver_set_throttle.
	Also check that we can connect to HAL before we start issuing commands,
	thanks to Trond HusÃ¸ for pointing this out!
	Call the idle calculation function every 5 seconds.

	* src/gpm-prefs.{c|h} : Wightspace fixes.

2005-09-13  Richard Hughes  <richard@hughsie.com>

	* configure.in: bump to 0.2.3.1

	* Makefile.am, gnome-power-manager.service.in : Make DBUS
	auto-launch services work.

	* docs/compile.php : Add note about pmscripts and rawhide kernel

	* glibhal-callback : Rename registered to reg to avoid GCC complaining.

	* src/gpm-main.c : Add info to check the FAQ page before reporting
	emailing me with bugs.

	* src/gpm-notification.c : Change #if to #if defined(foo) to shut up
	GCC's extra warnings. Add note about running on a desktop machine.

	* src/gpm-prefs.c : Add config.h - this was causing libnotify not to
	be defined.
	Also add gpm_is_on_ac () so we can jumpstart g-p-m if not running, and
	display a warning if impossible.
	Also convert to the dynamic option comboboxes. This allows us to choose
	more sane options for each combo.

2005-09-09  Richard Hughes  <richard@hughsie.com>

	* src/glibhal-callback.{c|h} : Finish the backend code.

	* src/gpm-main.c : use the swanky new backend code. (still disabled by
	default)

	*  src/gpm-prefs.c, src/preferences.glade: Patch from
	Jaap Haitsma <jaap@haitsma.org> to remove the obsolete hdd spindown
	checkbox. Thanks!

2005-09-08  Richard Hughes  <richard@hughsie.com>

	* src/hal-glib.{c|h} : Removed these files.

	* src/dbus-common.{c|h} : New files providing the basic dbus glib
	functionality, e.g. dbus_get_service.

	* src/glibhal-main.{c|h} : New files providing the core glibhal
	functionality, e.g. reading a boolean value.

	* src/glibhal-extras.{c|h} : New files providing the extra glibhal
	functionality, e.g. changing the screen brightness.

	* src/glibhal-callback.{c|h} : New files providing the callback
	functionality of glibhal, e.g. libhal_device_removed.

	* src/*.c : Adjusted to new glibhal framework
	(which we still don't use yet - working with the old libhal)

	* src/Makefile.am : Adjusted to new glibhal framework.

2005-09-08  Richard Hughes  <richard@hughsie.com>

	* docs/faq.php, docs/index.css: Update, and make a quick table for all
	new faq's at the top of the page.

	* src/hal-glib.c (dbus_glib_error): Do not print to warning level for
	a missing key, only print to debug. This was causing false bugreports.

	* src/gpm-main.c (main): Fix the typo for session connection checks.
	This was the reason 0.2.2.1 was pushed out the door so fast. Thanks to
	Mike Bydalek for testing and reporting the problem so fast.

	* src/gpm-notification.c (get_tooltip_state): removed and inlined as
	only one user.

	* gnome-power-manager.spec.in: Fix the problem where stderr wasn't
	being redirected in the gconf section.

2005-09-07  Richard Hughes  <richard@hughsie.com>

	* configure.in: bump to 0.2.3

	* docs/pm.php, docs/menu.php: Remove PowerManager docs as obsolete.

2005-09-06  Richard Hughes  <richard@hughsie.com>

	* gnome-power-manager.schemas.in: Fixed the problem where the
	noticiation icon wasn't being shown by default.
	(Add the missing general/display_icon)

	* src/gpm-main.c: Warn user when dbus session server is not running

	* doc/faq.php: Add FAQ entry for the libnotify dbus problem.

	* src/hal-glib.c: Make get_system_connection and get_session_connection
	not abort on failed connection (as we wan't to trap the error.)

	* po/pl.po: New Polish translation by MichaÅ Kastelik
	<mkastelik@gmail.com> - Many thanks.

	* configure.in: add pl translation.

	* configure.in, Makefile.am: Make docbook2man a automatic configurable.
	If this program is missing, the man files will not be built.
	Suggested by Eugenia Loli-Queru.

	* gnome-power-manager.conf, src/gnome-power-service.xml,
	src/gpm-common.h: s/net.sf.PowerManager/org.gnome.GnomePowerManager

	* docs/dbus_interface.php, src/gnome-power-service.xml, src/gpm-main.c:
	Add isOnBattery, isOnUps, isOnAC and remove isRunningOnMains.

	* src/gpm-common.h: Remove last bits of CVSHAL (obs. now we depend on
	0.5.4). Also make GPM_SIMULATE half-logical.

	* src/gpm-main.c: make more of LIBHAL_EXPERIMENT work -
	a future libhal replacement. (note, still disabled)

	* src/gpm-prefs.c: new function, gpm_is_on_mains() - so we can adjust
	the correct LCD slider depending if we are on AC or batteries.

	NEWS: Update, and format to standards, not just a random dumping ground
	for all my pre-paste news :-)

	doc/faq.php, doc/report_bug.php: Update with latest FAQ's :-)

2005-09-05  Richard Hughes  <richard@hughsie.com>

	* configure.in: bump to 0.2.2

	* src/makefile.am: Fix from wrobell <wrobell@pld-linux.org> to fix
	compilation on PLD Linux.

2005-09-05  Richard Hughes  <richard@hughsie.com>

	* gnome-power-manager.schema.in: Fix the problem where reboot or halt
	weren't being called correctly. i.e. do s/usb/usr. oops.

2005-09-04  Richard Hughes  <richard@hughsie.com>

	* configure.in: Add -fstack-check -pedantic -Wfloat-equal -Wundef
	-Wpointer-arith -Wbad-function-cast -Wredundant-decls to check code.

	* docs/images/drop-down.png, docs/gnome_power_manager.php:
	Remove surpus image.

	* docs/images/gpm-taskbar.png, docs/images/pref-advanced.png,
	docs/images/pref-main.png, docs/images/pref-options.png: Update.

	* src/gpm-common.c, src/gpm-common.h, src/gpm-dbus-test.c,
	src/gpm-main.c, src/gpm-notification.c, src/gpm-prefs.c,
	hal-glib.c, hal-glib.h: Fix up *lots* of compiler warnings, and make
	more C99 compliant. Also refactored code a little.

	* src/gpm-main.c: Add --version switch to just print the version.

	* doc/report_bug.php: New file, how to file a perfect bug.

2005-09-01  Richard Hughes  <richard@hughsie.com>

	* configure.in: Bump to 0.2.1
	Add new Italian translation by Daniele Medri <daniele@medri.org>.

	* src/gpm-common.h, gpm-main.c: s/LCDPanel/LaptopPanel to match HAL CVS.
	Move g-p-p enums to gpm-prefs.h.

	* src/gpm-main.c: Fix a problem for Andrew Duggan where the incorrect
	ACPI reading was tripping up our over-zealous checks. I've removed the
	check that was the issue, which should hopefully fix the issue.

	* src/gpm-prefs.c: Move get_devices_capability and
	get_devices_capability_with_value to src/hal-glib.c (
	hal_num_devices_of_capability, hal_num_devices_of_capability_with_value)
	Also do s/POLICY_NONE/POLICY_SLEEP.

	src/hal-glib.c: s/LCDPanel/LaptopPanel to match HAL CVS.

	src/preferences.glade: Fix combobox_sleep_type, and move to options tab.

2005-08-30  Richard Hughes  <richard@hughsie.com>

	* src/icons/gnome-power-system-ups-{0..8}-of-8.png: Added back by
	popular request.

	* NEWS: Update.

	* src/icons/Makefile.am: Add UPS icons.

	* src/gpm-notification.c: use UPS icons. Also fix a bug where {junk}%
	was dislayed when primary battery not present.

2005-08-30  Richard Hughes  <richard@hughsie.com>

	* configure.in: Bump to 0.2.0, signifying the obsolete of PowerManager.
	Also raise hal dep to 0.5.4

	* src/gpm-main.c: Remove code using USE_POWERMANAGER.

	* gnome-power-manager.schemas.in: Use "halt -s", not shutdown.

	* doc/faq.php: Explain the obsolete PowerManager.

	* gnome-power-manager.spec.in: Add "Obsoletes: PowerManager" so that
	we uninstall the PowerManager Daemon.

2005-08-30  Richard Hughes  <richard@hughsie.com>

	* src/preferences.glade: Fix the combobox padding, and make all siders
	update policy to "continous" so we can do some clever stuff with steps.

	* src/gpm-prefs.c: Rename capability to lcdpanel.

	* src/gpm-main.c: fix a warning for:
	"g_value_set_uint: assertion `G_VALUE_HOLDS_UINT (value)' failed"
	by switching to return a G_TYPE_UINT value.

	* src/gpm-main: (hal_set_brightness, hal_set_brightness_item):
	Create new functions to support the new
	org.freedesktop.Hal.Device.LCDPanel.SetBrightness method.

	* src/gpm-common.h: Add HAL_DBUS_INTERFACE_LCD

	* src/hal-glib.{c|h}: Move hal specificy code into here from gpm-main.

	* src/gpm-prefs: (format_value_callback_percent): Set to 1 digit
	precision, e.g. 56.3% so we can do steps.

	* src/gpm-prefs: (callback_hscale_changed): Add divisions support so
	we can lock to correct values for LCD brightness.
	This also lets us snap to 5 minute intervals for the sleep hscale's.

2005-08-26  Richard Hughes  <richard@hughsie.com>

	* doc/compile.php: Add information about CVS and Fedora core, and
	Fedora rawhide.

	* doc/faq.php, doc/menu.php, doc/index.css: Add FAQ page.

2005-08-21  Richard Hughes  <richard@hughsie.com>

	* src/gpm-common.c: removed update_percentage_charge as we now depend on
	CVS HAL.

	* src/gpm-main.c: Remove all code paths that rely on !CVSHAL.

2005-08-21  Richard Hughes  <richard@hughsie.com>

	* src/gpm-main.c, src/preferences.glade: removed the user setting of
	hard drive spindown time, and double click action.
	This was agued by many as having no place in the UI.

	* src/gpm-main.c (hal_setlowpowermode): add a new funtion to call
	SetPowerSave on the HAL root computer object.

	* Makefile.am: Use the new define, DBUS_SYS_DIR

	* configure.in: Add configuration for DBUS_SYS_DIR and DBUS_SERVICES_DIR
	I hope these don't break the RPM :-)

	* gnome-power-manager.service.in: new file, will act as a future service
	file for the dbus service.

2005-08-23  Richard Hughes  <richard@hughsie.com>

	* po/*.po, src/gpm-main.c: Changed explaination to explanation.

2005-08-21  Richard Hughes  <richard@hughsie.com>

	* src/gpm-main.c (update_has_logic): removed as we can trivially move the
	remaining checks into the state check function.
	Fix detection of onBatteryPower so that it's instantaneous.

	* src/gpm-prefs.c (get_devices_capability_with_value): New function, so
	that we can match a capability with a key string. Useful for buttons
	and ide drives.

2005-08-20  Richard Hughes  <richard@hughsie.com>

	* Make the gnome-power.foo files into gnome-power-manager.foo files.
	CVS churn...

	* src/gpm-common.h, src/hal-glib.c, src/hal-glib.h, src/gpm-main.c: Make
	hal_device_get_* to return success value rather than data so we can
	test for the tag not existing. This is needed for CVSHAL.
	Also add hal_free_capability convenience function.

	* src/gpm-prefs.c, src/gpm-main.c, src/gpm-common.h: Start getting rid of has*
	gconf data keys	- all that remain are hasBatteries and hasAcAdaptor -
	also need to make proper the solution in gpm-prefs w.r.t. the
	button handling.

	* gnome-power.schemas.in: Remove all the has* keys as we are not setting
	or reading these values now.

2005-08-19  Richard Hughes  <richard@hughsie.com>

	* src/gpm-notification.c, src/gpm-main.c, gpm-notification.h, src/gpm-common.h:
	Add a warning when show_icon is set to false.
	Remove the struct IconData as the show and show_if_full gconf values
	can now be read for each icon refresh as they are quick. The global
	variable main_icon could be reduced in scope to one function, so I did
	that too.
	Remove the setupData field as we can now set GPM_SIMULATE (instead of
	doActions) and verbose is just a global now.

	* src/gpm-notification.c: Removed the ability to generate our own icons,
	so we'll rely on the packaged ones. This desision wasn't taken lightly,
	but a11y considerations meant this had to be removed.

	* src/gpm-common.h: Add the HAL dbus defines.

	* src/gpm-main.c: Start adding the CVS HAL method support in. Also
	un-#if the GSCREENSAVER stuff - worst case we get a dbus warning if
	not present.

	* gnome-power.spec.in, doc/index.html: Bump to dep of hal 0.5.4

	* src/gpm-dbus-test.c: s/GPM_DBUS_POWEROFF/GPM_DBUS_SHUTDOWN to match.

	* gnome-power.schemas.in: Add general/cmd_reboot and
	general/cmd_shutdown so that we can get rid of PowerManager.

	* doc/index.html: Remove pmscripts as this has been taken over with
	pm-utils carried upstream.

2005-08-17  Richard Hughes  <richard@hughsie.com>

	* gnome-power.schemas.in: Remove /apps/gnome-power/lockdown/* as we can
	now use hald. Remove /apps/gnome-power-manager/policy/UPSCritical as we
	can use BatteryCritical. Improved lots of short descriptions.
	Do s/gnome-power/gnome-power-manager and s/AC/ac and
	s/Batteries/batteries (and convert StudlyCaps to usual_style) so that
	we are more consistant as a Gnome application. Fixes suggested by
	David Zeuthen.

	* src/gpm-notification.c, src/gpm-main.c, src/gpm-common.h: remove
	lockdown stuff,	and also use the new gconf keynames.

	* gpm-prefs.c: Remove combobox_ups_critical

	* TODO: Update.

	* src/gpm-main.c: Remove the GPMGLIB stuff as we don't compile anymore
	with !GPMGLIB thanks to all the new code.
	Also refactored the signal stuff into nice inline functions.

2005-08-16  Richard Hughes  <richard@hughsie.com>

	* src/gpm-dbus-common.{c|h}: Now the GLIB signal stuff is working,
	remove these empty files. The GLIB dbus stuff allows us to clean up the
	source substantially. I will be making the GPMGLIB stuff enforced,
	i.e. removing compatability with the older dbus's.

	* src/gpm-main.c (action_policy_do): New function (gscreensaver_lock).
	Add the commands to lock the screen using gnome-screensaver. Thanks to
	Diego GonzÃ¡lez for the basis for this patch.

	* src/gpm-common.h: Add the GS_DBUS_SERVICE, GS_DBUS_PATH, and
	GS_DBUS_INTERFACE defines here.

2005-08-15  Richard Hughes  <richard@hughsie.com>

	* Apply patch from Steev Klimaszewski to change a TIMOUT to TIMEOUT
	- which I blame entirely on this laptop keyboard.

	* configure.in: Add --enable-gscreensaver to configure arguments so that
	we do not try to read in the gconf values and throw an error if this
	program is not built. We still need to write the auto check for
	gnome-screensaver in configure.in. Spotted by Steev Klimaszewski.
	

	
	* src/gpm-main.c, src/gpm-main.c: Sprinkle with #if HAVE_GSCREENSAVER
	so that we disable the un-needed parts.

	* src/gpm-dbus-common.c: Fix the PowerManager interface line. Note that
	this file is going when we go 100% glib.
	Also PowerManager support is going when HAL gets event support (soon).

	* src/gpm-notification.c: Remove setup.hasQuit and setup.hasActions and
	the associated logic.

2005-08-14  Richard Hughes  <richard@hughsie.com>

	* Update src/pixmaps/gnome-dev-acadapter.png so that it matches the
	"dfong" bluecurve theme.

	* gpm-main.c: Continue playing with LIBHAL_EXPERIMENT so that we can
	remove the libhal dep and use the pure glib bindings. With this we are
	uncovering lots of problems with the glib dbus bindings and so is a good
	thing :-) If you use LIBHAL_EXPERIMENT then please use CVS dbus, else
	little will work. Thanks to davidz and walters for all the help so far.

	* src/gpm_marshal.list: Added marshal file for use by glib-genmarshal

	* src/Makefile.am: Add support for gpm_marshall.c and gpm_marshall.h

2005-08-09  Maxim Dziumanenko <mvd@mylinux.ua>

	* configure.in: Added "uk" to ALL_LINGUAS.

2005-08-04  Richard Hughes  <richard@hughsie.com>

	* gpm-common.h: Add GPMURL define

	* gpm-dbus-common.{c|h}: Remove the signal stuff we don't use and we
	now use the glib method stuff unconditionally, so remove them.

	* gpm-main.c: Use the libnotify glib initialisation stuff.
	Also start experimenting with GLIB methods.

	* gpm-prefs.c: Use the libnotify glib initialisation stuff.

	* configure.in: Bump to 0.2.1

	* Makefile.am: Add the glib glue stuff.

2005-07-28  Richard Hughes  <richard@hughsie.com>

	* src/gnome-power-service.xml: Comment out stuff we are not using.

	* src/gpm-main.c: Continue playing with glib.

	* src/gpm-dbus-common.{c|h}: Remove the obsolete method functions
	Signals are next on the hit-list.

2005-07-28  Richard Hughes  <richard@hughsie.com>

	* src/hal-glib.c, src/hal-glib.h: new files for the glib libhal functions

	* src/Makefile.am: add hal-glib.{c|h} into the build.
	
	* src/gpm-main.c: use the glib libhal functions as it makes everything
	easier to read and debug.

	* src/gpm-main.c (pm_do_action, set_hdd_spindown_device): Communicate
	with PowerManager using the glib bindings. Try and initialise as much
	as we can with dbus-glib. Notice a trend?

	* src/gpm-main.h: put all constants in gpm-common.c

	* Makefile.am: Remove Makefile.in's on maintainer-clean

	* src/gnome-power-service.xml: Update without the veto prefix,
	and add signals - this will prepare for the glib bindings in the future.

2005-07-25  Richard Hughes  <richard@hughsie.com>

	* src/gpm-prefs.c: Make sure we only use GCONF_ROOT once.
	Add libnotify box informing user that they do not have gnome-screensaver
	DPMS support.

	* src/gpm-common.h: Move NOTIFY_TIMOUT here.

	* src/gpm-main.c: Remove invalid gconf check.
	Added support for writing /apps/gnome-screensaver/dpms_suspend for
	gnome-screensaver.

	* configure.in, src/Makefile.am, src/gpm-notification.c,
	src/prefs.c: Make libnotify a configurable build option, on the advice
	of David Zeuthen.

	* gnome-power.spec.in: Add --enable-libnotify.

2005-07-25  Richard Hughes  <richard@hughsie.com>

	* gnome-power.spec.in: Do not restart messagebus on install

	* src/gnome-power-service.xml: new file, prepare for dbus glib'ification.
	We will be able to remove lots of code when we use the glib bindings.

2005-07-21  Richard Hughes  <richard@hughsie.com>

	* src/gpm-dbus-test.c: Added back the NameOwnerChanged signals.
	Add some #ifdefs to allow test.c to use gpm-dbus-common.h
	Added some help text in the --help screen.

2005-07-21  Richard Hughes  <richard@hughsie.com>

	* README, docs/index.html: updated dep information.

	* src/preferences.glade: Add some new sexy stuff.

2005-07-21  Richard Hughes  <richard@hughsie.com>

	* dbus-interface.html: Removed as information is more up to date in docs/

	* autogen.sh: Changed to use gnome-common

	* src/sounds/critial.wav: New sound file from GAIM for critical notification

	* src/sounds/normal.wav: New sound file from Iagno for other notifications

	* src/gpm-main.c (use_libnotify): Now do a sound for the notifications.
	I don't think libnotify supports this yet, but when it does, this should
	"just-work" :-)

	* src/gpm-prefs.c (recalc): Add support for missing lid/power/sleep buttons.
	Also add the GCONF_ROOT prefix to the keys manually, so we can use
	gnome-screensaver ones in the future.

	* src/preferences.glade: Name the labels so that the above works correctly.

	* gnome-power.spec.in: Add gnome-common dep, and update others.

	* configure.in: Add src/sounds/Makefile and src/icons/Makefile

	* src/sounds/Makefile.am: New file, to add the wave files.

	* src/icons/Makefile.am: New file, and move over the icons. This means we
	can install different icon sets, e.g. bluecurve, gnome or LowContrast if
	people don't like the icons.

	* src/gpm-notification.c (callback_about_activated): No point displaying
	"Unknown Translator" for un-translated files.

2005-07-20  Richard Hughes  <richard@hughsie.com>

	* src/pixmaps/gnome-power-system*.png: New icons thanks to Diana Fong
	and David Zeuthen. They look great - thanks!

	* docs/images/*.png: Update screenshots to a bit more recent.

	* src/gpm-notification.c (get_icon_position): New function, tell libnotify
	where to point to. This is a bit rough-and-ready at the moment but seems to
	work well.

	* src/gpm-main.c (use_libnotify): Now setting an image with position, lets
	see what people think.

	* src/gpm-dbus-server.c (dbus_method_handler): Add in all the existing
	signals as methods. dbus-glib, where for art thou. :-)

	* src/gpm-dbus-server.c (dbus_signal_filter): Removed support for the
	signal API.

2005-07-19  Richard Hughes  <richard@hughsie.com>

	* src/pixmaps/gnome-power.png: New file (we now have an icon thanks to
	Diana Fong)

	* src/pixmaps/Makefile.am: Added gnome-power.png

	* configure.in: We now require dbus-glib-0.35.2 (an unpopular move).
	I want to use the new glib bindings throughout the programs. There is too
	many dbus wrapper-type functions that add to bloat and make the program
	generally difficult to read. After reading the dbus-glib sample code,
	I'm sure this is the way to go. For all you FC4 users, rawhide's DBUS seems
	to work well with no ill effects.

	* doc/*: Updated documentation with new logo, and a few new screenshots.

	* src/gpm-dbus-test.c: Converted to just use the glib bindings - this file
	is a bit of a mess at the moment, but you see the plan. I'm thinging making
	ACK, NACK etc, into methods instead of signals. Methods seem more the right
	thing to use, so I'll start converting gpm-dbus-server.c to accept these
	methods instead.

	* src/gpm-dbus-server.c: Add in method support for ACK, others to follow.

2005-07-18  Richard Hughes  <richard@hughsie.com>

	* configure.in: Changed module name to gnome-power-manager to better
	reflect the gnome module name. The next release will have a tarball
	gnome-power-manager.tar.gz instead of gnome-power.tar.gz

	* src/pixmaps/Makefile.am: New file, splitting from src/Makefile.am -
	I should have done this a long time ago.

	* Makefile.am, src/Makefile.am: Tidy up, and move the build of
	preferences.glade to src/ - it never belonged here anyway.
	Also, we'll now use /usr/share/gnome-power-manager to be more specific.

2005-07-18  Adam Weinberger  <adamw@gnome.org>

	* configure.in: Added en_CA to ALL_LINGUAS. I think it's important
	  right now to note that nearly every single source string in the
	  entire program has at least one grammar or spelling error.

2005-07-17  Richard Hughes  <richard@hughsie.com>

	* src/gpm-notification.c: Made eggtrayicon a global, and got rid of the
	complicated icon->td structure. We don't need to be so complicated now
	we only have one icon.

	* src/*dbus*.c: Added note that we will be changing to glib bindings soon.

	* TODO: updated.

2005-07-17  Christophe Merlet  <redfox@redfoxcenter.org>

	* configure.in: Added "fr" to ALL_LINGUAS.

2005-07-16  Christian Rose  <menthos@menthos.com>

	* configure.in: Added "sv" to ALL_LINGUAS.

2005-07-15  Richard Hughes  <richard@hughsie.com>

	* src/gpm-dbus-server.c (vetoActionUnregisterInterest): Add an option so we
	can supress the error (for random client disconnections)

	* src/gpm-prefs.c (main): set hscale_battery_critical on load, not just on
	change,	else we get the slider changing in unpredictable ways.

	* src/gpm-*.c: s/g_assert/g_return_if_fail and g_return_val_if_fail
	This will make the programs a little more error friendly (we still get
	critical errors, but the program doesn't die)

	* src/gpm-notification.c: Finish removing the low_icon mess.

	* src/gpm-notification.c (callback_about_activated): Added translatable
	string "Unknown Translator" for all you translators to get a bit of credit.

2005-07-15  Terance Sola  <terance@lyse.net>

	* configure.in: Added "nb" and "no" to ALL_LINGUAS.

2005-07-14  Richard Hughes  <richard@hughsie.com>

	* gnome-power.preferences.desktop.in:
	Replace "GNOME Power Preferences" with "Power Preferences" - we shouldn't
	have "GNOME" in the Preferences menu title.

	* src/gpm-main.c (read_battery_data): Re-arrange the initialisation to
	known defaults so that valgrind doesn't get upset with a UPS attached.

	* gnome-power.schemas.in: Added criticalThreshold value

	* gpm-prefs.c (callback_hscale_changed): Add in new code for
	criticalThreshold, and make sure that criticalThreshold > lowThreshold
	by changing the limits of the criticalThreshold slider.

	* src/gpm-main.c (property_modified): Added notification and action for
	battery critical. Now we are cooking with gas.
	p.s. Thanks to the translators for all the recent work. Appreciated.

2005-07-15  Abel Cheung  <maddog@linuxhall.org>

	* configure.in: Added "mk" to ALL_LINGUAS.

2005-07-13  Francisco Javier F. Serrador  <serrador@cvs.gnome.org>

	* configure.in Added to LINGUAS "es" and missing  "pa" and "zh_CN".

2005-07-13  Richard Hughes  <richard@hughsie.com>

	* configure.in: Add check for libnotify.

	* src/gpm-common.c: Add initial code for libnotify support. Patches for
	libnotify and DBUS 0.33 have been sent upstream, along with a spec file
	for FC4. Ubuntu is also packaging this in the next few weeks, so the
	extra dep shouldn't be a problem.

	* src/gpm-main.c (use_libnotify): new function, convenience. Added lots more
	notifications where we used to have dialogues, for the warning states.

	* src/gpm-common.c (property_modified): Fix bug where update_state_logic
	was being called with coldplug TRUE, when it quite plainly isn't.

	* src/gpm-common.c (get_timestring_from_minutes): Fix translationable string
	to be constant number. Fix from Hendrik Brandt, thanks.

	* gnome-power.schemas.in : Change tense of a description to be less like the
	borg :-) Fix from Hendrik Brandt, thanks.

	* doc/*: Added lots more information and other images.

	* src/preferencs.glade: Name the new label label_double_click so we can
	disable it :-)

	* src/gpm-prefs.c: Disable the double click stuff for now

	* src/gpm-main.c (property_modified): Add the code where the user is
	informed of the low battery state. This works for any rechargeable device.

2005-07-12  Richard Hughes  <richard@hughsie.com>

	* src/gpm-main.c (set_hdd_spindown): New stub function that sets the
	spindown for all hard-drives attached to the system.

	* MAINTAINERS, README.cvs: new files, needed for movement to GNOME CVS
	servers. I'll update the help when they allow anonymous checkouts.

	* doc/*: New folder with quite a bit of documentation in HTML form.

2005-07-12  David Zeuthen  <davidz@redhat.com>

	* src/gpm-notification.c (create_icon_pixbuf): Use the new icons
	for system-wide power state so it's much easier to theme

	* src/Makefile.am:
	(Data_DATA): Add pixmaps/gnome-power-system[-ac]-[0-8]-of-8.png

	* src/pixmaps/gnome-power-system[-ac]-[0-8]-of-8.png: New files

2005-07-11  Richard Hughes  <richard@hughsie.com>

	* gnome-power.spec.in : Added depend of PowerManager - this is now the
	only way we can call root scripts. PowerManager is only a temp fix,
	HAL will have the required actions soon.
	Fedora Extras fixes from Andreas Thienemann, thanks!

	* gnome-power.schemas.in : Removed the scripts/ gconf directory.
	Removed the ShowIconLow boolean as we don't support this anymore.

	* src/gpm-dbus-common.c : Add convert_dbus_enum_to_string () so we can make
	the interactive prompts more user-friendly.

	* src/gpm-dbus-list.c : Removed, as we can use the dbus tools instead.

	gnome-power-manager.sgml, gnome-power-preferences.sgml : New files from
	Oliver Grawert <ogra@ubuntu.com> for man support. Still need to fill these
	in to be complete, and up to date (and to patch Makefile and spec) but
	I've uploaded them so people can see them and improve them.

2005-07-07 Richard Hughes  <richard@hughsie.com>

	* src/gpm-dbus-common.h : Renamed net.sf.PowerManager to
	net.sf.GnomePower so we can use a desktop agnostic backend.
	Add PM_DBUS_INTERFACE as a test.

	* src/gpm-dbus-common.h : Create pm_do_action () as a test using PM_DBUS.

2005-07-04 Richard Hughes  <richard@hughsie.com>

	* dbus-interface.html : New file, detailing the DBUS interface and
	progress.

	* src/gpm-dbus-server.c : Continue to impliment the spec (above)

	* src/gpm-dbus-test.c : Start writing lots of tests so we can really
	pound the PowerManager DBUS interface.

	* src/gpm-main.c : Now does action ACPower fail. Noticed by Ow Mun Heng.

	* .cvsignore, po/.cvsignore, src/.cvsignore : New files to help me
	keep on top of the CVS directories.

2005-07-02 Richard Hughes  <richard@hughsie.com>

	* src/gpm-dbus-test.[c|h] New files for test DBUS service.
	* src/gpm-dbus-list.[c|h] New files for test DBUS service.
	* src/gpm-dbus-server.[c|h] New files for test DBUS service.
	* src/gpm-dbus-test.[c|h] New files for test DBUS service.
	* gnome-power.conf : New DBUS conf file
	(belongs in /etc/dbus-1/system.d/)

	* src/Makefile.am : Added the above files to build the new DBUS bits.

	* src/clipboard.{c|h} : Removed these files as we can use DBUS for
	startup checking.

	* Makefile.am : Installed /etc/dbus-1/system.d/gnome-power.conf
	* gnome-power.spec.in : Install /etc/dbus-1/system.d/gnome-power.conf
	and restart messagebus.

2005-07-01 Richard Hughes  <richard@hughsie.com>

	* src/gpm-notification.c : Removed the low icon code in prep for
	DavidZ and Andrei's patches. Code is simpler and less complicated.
	Also created create_virtual_of_type() to play with. May be usefull for
	multi-instance devices like batteries where we want to average the values.

2005-06-30 Richard Hughes  <richard@hughsie.com>

	* src/prefs.glade : split some options into a new tab.

	* src/gpm-notification.c : After discussing with Paul Ionescu, I've
	created the new funtion get_percentagecharge_batteries () that
	understands multibattery setups. Hopefully this should be useful.
	Also made this function work. += is the correct line, =+ is incorrect!

	* src/gpm-notification.c : Also added the new functions
	get_tooltip_state () and get_object_tooltip () which will hopefully
	help the work Andrei is doing with the new left click menu.

2005-06-28 Richard Hughes  <richard@hughsie.com>

	* Makefile.am : Fix typo that was tripping up intltool-*
	* src/Makefile.am : Add *.h files so that we pass make distcheck
	Patches from Andrew Duggan - thanks.

2005-06-27 Richard Hughes  <richard@hughsie.com>

	* PATCH: Converted names to be clearer on advice of Jaap Haitsma:
	common 	-> 	gpm-common
	gpm 	-> 	gpm-main
	gpn 	-> 	gpm-notification
	prefs 	-> 	gpm-prefs

	You can get the old versions using:
	http://www.cs.utexas.edu/users/almstrum/cs373/general/cvsguide.html#revision

	* Removed icons.{c|h} as we don't need stub functions.

2005-06-22 Richard Hughes  <richard@hughsie.com>

	* src/gpn.{h|c} : Add showIfFull to IconData struct so we can update
	on the fly.

	* src/prefs.c : Fix a bug where we automatically overwrite the value of
	displayIconFull and displayIconLow (to true) on g-p-p startup.

	* src/Makefile.am : Remove discharging.png as it's no longer part of
	the build.

	* src/gpn.c : new function get_object_of_powertype () - helps us with
	the displayIconFull problem. We should do the right thing with the
	main icon now. Reported by Paul Ionescu - Thanks.

2005-06-21 Richard Hughes  <richard@hughsie.com>

	* src/common.c : Add POWER_AC_ADAPTER to convert_powerdevice_to_gnomeicon

	* src/gpm.c (add_ac_adapter) : Make sure we set struct fields
	(like isRechargeable) to a known value. Fixes the problem of a desktop
	showing an ac_adapter icon with an overlay.
	Also create a new funtion (read_battery_data)to seporate creating the
	battery object and populating it. Solves the crash at boot with no
	batteries inserted. We can also populate known data if the battery isn't
	present like we did for ac_adapter.
	Reported by Paul Ionescu. - Thanks.

	* src/Makefile.am : Change ac_adapter.png to gnome-dev-acadapter.png

2005-06-19 Richard Hughes  <richard@hughsie.com>

	* po/de.po : New file - translation from Hendrik Brandt - thanks!

	* src/{gpm|prefs|gpn|common}.c : Mark some strings translatable

	* po/POTFILES.in : Add the above files for translation.

	* configure.in : add translation de.

	* src/gpn.c : Add initial LCD work, but don't enable it yet.

2005-06-19 Richard Hughes  <richard@hughsie.com>

	* src/{gpm|prefs|gpn}.c : replace /apps/gnome-power/ with GCONF_ROOT

	* src/common.c : make some simple functions return gchar rather than
	GString to speed them up. We don't need to be overly clever for no gain.
	Removed convert_powerdevice_to_haltype () as unused.

	* gnome-power.schemas.in : Add /apps/gnome-power/general/displayIconFull
	so we can ignore a fully charged device. Requested as feature.
	Also add:
	/schemas/apps/gnome-power/lockdown/{shutdown|suspend|hibernate|reboot}
	so we can use sabayon to lock down users to not do specific things.
	Distros can use this (e.g. Fedora) if they consider an action dangerous.
	We could use HAL in the future for this information, and we definatly
	need to work out what the hardware can do. No point displaying
	"Hibernate" if the machine is of type APM, for instance.

	* src/prefs.c : Added variable displayIconFull and added in checks for
	the new checkbox checkbutton_display_icon_full.

	* src/common.h : Added lockdown stuff to SetupData.

	* src/gpm.c, src/gpn.c : Read in lockdown information to SetupData, and
	apply when needed. Only refreshed on program invocation as the data
	isn't going to change frequently, if at all.

2005-06-18 Richard Hughes  <richard@hughsie.com>

	* configure.in : Bump to 0.0.6 as I released 0.0.5 today.

	* src/prefs.c : Remove the horror that was getPolicyFromWidgetname ()
	- replace with sexy g_object pointers.

	* gnome-power.schemas.in : Add /schemas/apps/gnome-power/scripts/
	{shutdown|suspend|hibernate|reboot} after talking to David Zeuthen about
	HAL events (which might not be used on all distros/archs..)
	We can always use:
		dbus-send --system --dest=org.freedesktop.Hal  \
		/org/freedesktop/Hal/devices/computer \
		org.freedesktop.Hal.Device.SystemPower.Suspend
	When HAL event support is added, this can be patched in by distros.

	* src/common.h : Added ACTION_REBOOT

	* src/gpn.c : Added callback_actions_activated so we can get some
	callbacks for the actions such as "Shutdown"
	Also add menu_add_separator_item to split the menu up a bit,
	Add menu_add_action_item's for all the states. At the moment all the
	states are shown (irrespective to whether supported) but this is mainly
	for my testing.

	* src/Makefile.am, src/pixmaps/gnome-* : Add icons for actions.

	* src/common.c, src/prefs.c : Remove stdio.h includes as not required.

	* src/info.c : Removed as unused.

	* src/gpm.c : Added call to g_type_init () as some users were getting:
	GLib-GObject-CRITICAL **: gtype.c:2254: initialization assertion failed,
	use IA__g_type_init() prior to this function.
	- lets hops this fixes it.

	* src/gnome-power.spec.in : Fixed a typo where integer should be int.

2005-06-16 Richard Hughes  <richard@hughsie.com>

	* src/gpm.c, src/common.c : valgrind doesn't like "Conditional jump or
	move depends on uninitialised value(s)" when ->present is assumed true.
	Add check in add_ac_adapter () just use the ->percentageCharge directly.

	* src/gpn.c (create_icon_pixbuf) : Use gtk_icon_info_free () as we
	leak memory otherwise. Thanks valgrind.

	* src/gpm.c : Add check for battery.charge_level.rate so we don't spew
	g_message's.

2005-06-15 Richard Hughes  <richard@hughsie.com>

	* src/*.[ch] : Fix from David Zeuthen to get rid of DOS newlines.
	The moral of the story is not to email yourself code from outlook.

	* src/*.[ch] : Add in GPLv2 text to make licencing clearer.

	* src/*.c : Make code better fit in 80 char line.

	* src/gpm.c : Remove UPS hack as patch is upstream.

	* src/logger.* : Removed these files as we are swiching to glib
	based logging.

	* src/gpn.c, src/gpm.c, src/common.c, src/icons.c, src/prefs.c : Switch
	to g_log functions from GPM_ type macros. Smaller code, yay.

	* src/common.c : New function, g_log_ignore (this will ignore messages
	for us when non-verbose)

2005-06-13 Richard Hughes  <richard@hughsie.com>

	* src/gpn.c, src/gpm.c, src/common.c, src/icons.c, src/prefs.c :
	Remove "!= NULL" from g_assert statements as not needed.

	* Added code from Andrei Yurkevich for dynamic icons,
	e.g. icons that do not have the colour bar hardcoded. Big thank you.

	* src/gpn.c : New functions: level_bar_get_color, create_icon_pixbuf

	* src/icons.c : new function: icon_modify_image_pixbuf

	* src/common.c : New function: convert_powerdevice_to_gnomeicon
	Removed : get_icon_filename, get_powerstate_discrete

	* src/Makefile.am : Remove all the icons, and move some to pixmaps,
	also removed reference to object_table.c

	* src/icons/* : Removed thanks to Andrei!

	* src/pixmaps/* : Removed existing, replaced with GNOME default
	device icons so we are portable without complicated
	configue.in checks.

	* src/gpn.* : Removed filename field as it's not needed.

	* src/object_table.* : removed array functions, g_ptr_array is quick
	and more efficient than an array ,and gives us smaller, more
	elegant code.

	* src/common.h : removed MAX_ICONS for good :-)

	* configure.in : Bumped version to 0.0.5 (as we have had a
	LOT of new code in the last few weeks)

2005-05-31 Richard Hughes  <richard@hughsie.com>

	* src/gpn.c, src/gpn.c : New files - takes the notification
	functions out of gpm.c and make it more manageable in size.
	For the moment, use shared variables (no need for IPC as we
	are still one program..)

	* src/gpm.c : Convert to use the new gpn_ functions provided
	by gpn.c - also allow us to use the new constants ICON_MAIN,
	ICON_LOW and ICON_ALL.

2005-05-29 Richard Hughes  <richard@hughsie.com>

	* src/object_table.c : make object_table_find return void, and
	convert slotData to NULL if we do not find object - this will
	trigger the g_assert'ion, rather than seg-faulting in
	gpm.c:property_modified

	* src/gpm.c : To prevent g_assert'ing when first adding an
	ac_adapter after we have booted, add ac_adapter
	unconditionaly on present state.

2005-05-25 Richard Hughes  <richard@hughsie.com>

	* src/gpm.c : Add new functon "powerDeviceToHalType" to convert
	the powerDevice to the HAL name.
	Get action_policy_do working again, so that *Shutdown* events
	are triggered.
	Simplify property_modified so that we only check battery* and
	ac_adapter* keys. Also BUG when we can't find the device, as
	this signifies a bug in HAL.

	* src/icons/primary* : Rename the battery- icons to primary to
	avoid confusion with other types of batteries (this lets us use
	powerDeviceToHalType and simplify getIconFilenameFromSlot)

	* src/icons/pda*-c|-d* : Create the PDA charging/discharging
	icons so we could use them in the future if we wish.

	* src/Makefile.am : Add new PDA icons, and stop installing
	icons that we no longer use!

	* src/*.c : Changed some StudlyCaps function names to be more
	C-like, and consistant e.g.
	"getHoursStringFromMinutes" -> "get_timestring_from_minutes"
	Also changed a lot of int's to gint's and chars to gchars for
	glib portibility (makes no difference at the moment).

2005-05-25 Richard Hughes  <richard@hughsie.com>

	* src/common.c, src/common.h, src/gpm.c : Add a patch from
	Andrei Yurkevich for PDA support, see http://synce.sf.net
	for the hal-addon. Thanks!

	* src/common.c : refactored a lump of code to the function
	HalTypeToPowerDevice to abstract gpm.c a little.

2005-05-17 Richard Hughes  <richard@hughsie.com>

	* src/gpm.c : AC_ADAPTER should not be a valid choice for
	icon_low - check for this. Also document a few functions while
	I'm here.

2005-05-16 Richard Hughes  <richard@hughsie.com>

	* src/gpm.c, src/common.c, src/icons.c, src/prefs.c : Add a
	load of g_assert's to try and find all the funny crashes and get
	rid of the unneeded error paths where abort would be the best
	solution.

	* src/gpm.c : Be a lot more careful with freeing memory.
	Remove kludgey string logic in getIconFilenameFromSlot and use
	itegers and %03i format.

	* src/preferences.glade : Add the low threshold slider.

	* src/prefs.c : Support the new slider, adding new callback tools
	and modifying policy lookup function (getPolicyFromWidgetname)

	* src/gpm.c : Make threshold slider dynamically add/remove low icon.

2005-05-14 Richard Hughes  <richard@hughsie.com>

	* src/gpm.c : Fix a segfault in the situation on having no low
	power devices attached. Should also sort the problem of running
	GPM on a PC without any powerdevices, but this I'll have to check.
	Fixed a memory-leak where we were not calling free_icon_structure
	after removing an icon.

2005-05-13 Richard Hughes  <richard@hughsie.com>

	* src/gpm.c : fixed the saving of remaining_time for batteries.
	Rename the function mememe as it's a point of embarrassment. :-)
	Make get_main_tooltip use powerDeviceToString for consistency.

	* gnome-power.schemas.in : Added lowThreshold to the schema

2005-05-12 Richard Hughes  <richard@hughsie.com>

	* src/common.*, src/gpm.c : FINALLY sorted out the mess that was icon
	and tooltip generation. Next on my list is the actions support which
	is a mess as well. Lots of changes.

	* src/icons.* : Removed the filename parameter from icon_create to
	avoid having to do clever things before creating the icon. This may
	display the GTK broken image for a split second while loading,
	although I can't see it on my laptop at all.

	* src/object_table.c : Removed use of removed properties. Less junk.

	* gnome-power.schemas.in : Added displayIconLow to the schema

	* src/prefs.c, src/preferences.glade : Added displayIconLow support.

2005-05-11  Richard Hughes  <richard@hughsie.com>

	* src/common.* : Got rid of the ACPI calculation as the patch is now
	in HAL CVS that makes time_remaining part of the interface. Nice.

	* src/gpm.c : Got rid of the special case ACPI calculations.

	* gnome-power.schemas.in : Updates policy to reflect what we are
	actually using, and choose some defaults.

	* src/common.c : policyoption_to_enum, enum_to_policyoption :
	new functions to convert the enum ACTION_HIBERNATE into a string
	"hibernate" and vice versa, for use in gconf to prettyfy names.
	Still needs some work.

2005-05-09  Richard Hughes  <richard@hughsie.com>

	* src/* : Changed printf => g_print and fprintf(stderr) => GPM_ERROR
	on advice of Jaap Haitsma, thanks.

	* ../hal : Fixed up so that UPS's always set battery.present = TRUE.
	Also making progress on moving battery.time_remaining into HAL, rather
	than the mess of special cases we have in GPM at the moment.

	* src/common.* : New function, powerDeviceToString to make easy work
	of converting a magic number into a human string.

2005-05-08  Richard Hughes  <richard@hughsie.com>

	* src/icons.c, src/icons.h : Re-implimented the notification area
	icon destroy/create/modify functions to be more logical and
	segfault friendly as these functions have caused lots of crashes.
	Also made the dropdown menu icon specific rather than global for the
	different types of icon.

	* src/gpm.c : Changed to use new icon functions and misc cleanups.

	* src/common.h : Removed redundant icon checking fields.

	* src/prefs.c : Make the icon checkbox get it's value from gconf.

2005-05-05  Richard Hughes  <richard@hughsie.com>

	* New frontend according the GNOME HIG (2 weeks work!)

	* Backend displaying multiline tooltip and single icon, unless
	battery device is low (todo!)

	* Begin switching char* functions into GString functions.

2005-04-19  Richard Hughes  <richard@hughsie.com>

	* src/preferences.glade : misc grammar/spelling fixes from
	Simon Howard, Thanks!

	* src/icons/ups-*-*.png, src/Makefile.am: New UPS discharge and
	charge icons to match battery.

	* src/common.c : Support new UPS charging and discharging icons.

2005-04-18  Richard Hughes  <richard@hughsie.com>

	* configure.in, NEWS : Bumped version to 0.0.4

	* src/prefs.c : Removed the users ability to show/hide the
	ac-adapter icon as this is going away in 0.0.4

	* src/gpm.c, src/alert.c : Removed the alert checkbox on the
	advice of Paul Ionescu.

	* src/common.c : Removed getFilenameNumberFormat to simplify logic.

	* src/common.h : Added isDischarging property because
	isDischarging != isCharging :-)

	* src/icons/battery-*-*.png, src/Makefile.am: New discharge and
	charge icons, thanks to Paul Ionescu for the mockup and
	David Zeuthen for the idea.

2005-04-07  Richard Hughes  <richard@hughsie.com>

	* src/gpm.c : Fix some seg-faulting goodness when we try to modify
	a tooltip of an icon that was never created.
	Also added lots of function comments.

	* src/prefs.c : Make checkboxes use a SList like the combos.
	This neatens things up, and means gconf policy name doesn't have to
	match the libglade widgetname.
	Made the "help" button lauch a web-browser displaying g-p-m homepage.
	Also added lots of function comments.

2005-04-06  Richard Hughes  <richard@hughsie.com>

	* src/Makefile.am : Tidy up, don't include .h files here.

	* src/prefs.c : Got rid of the nasty, nasty arrays.

	* src/prefs.h : New file, just for preferences stuff

2005-04-05  Richard Hughes  <richard@hughsie.com>

	* src/gpm.c : Patch from Andrei Yurkevich to fix seg-fault on DBUS
	initialisation, thanks!

	* src/prefs.c : Massive overhaul so that gconf ky name is decoupled
	from libglade name - this lets us choose pretty names in gconf.
	Also made so that lcd_brightness is measured in percent in gconf
	so power-users could make changes without looking up the enum.
	Added error checking and suitable framework.

	* gnome-power.schemas.in, src/gpm.c, src/prefs.c : Make gconf names
	pretty, not ones derived from libglade.

2005-04-04  Richard Hughes  <richard@hughsie.com>

	* src/alert.c, src/alert.glade : New files for the about dialogue for
	battery low notification.

	* src/Makefile.am, Makefile.am : added information for gnome-power-alert,
	Uncommented the gconf install line, install .desktop file.

	* src/pixmaps/* : Added new icons with battery icons superimposed.

	* src/common.*, src/gpm.* : Removed .enabled from the struct, now using
	POWER_NONE to signify that there is no device. Also done lots more checking
	for NULL for the slotBase structures being passed around.

	* gnome-power-preferences.desktop.in : New file, create launcher to modify
	GNOME Power Preferences from the GNOME system menu.

	* gnome-power.spec.in : First version of the RPM spec, based mainly on
	GNOME Volume Manager's spec file. Produces RPM's ok, I think.

2005-04-03  Richard Hughes  <richard@hughsie.com>

	* autogen.sh : Made to automatically run ./configure on the advice of
	Jaap Haitsma.

	* src/gpm.c src/common.c : Add tweaks, and start to make interface suitable
	for DBUS.

	* src/common.h, src/icons.h, src/object_table.h : Split prototypes for
	header files to clean up include mess.

2005-04-01  Richard Hughes  <richard@hughsie.com>

	* src/logger.c, src/logger.h : New files for logging
	Shamelessly copied from hald, by David Zeuthen

	* src/gpm.c, src/common.c : Updated to better support Logitech mice and
	changed all the printing to stdout to use the new logging functions.

	* src/gpm.c, src/prefs.c, src/common.h, src/preferences.glade :
	Implemented the /icons/icon* gconf properties so that users can hide
	or show icons.

	* src/common.h : Removed type for battery, now we'll use a string for speed.

	* Makefile.am : Removed local-build powermanager.c - oops.

2005-03-30  Richard Hughes  <richard@hughsie.com>

	* doc/ : removed the temporary directory and split into the new
	CVS module www.

	* src2/ : removed the developmental directory and split into the new
	CVS module power-manager. The code is in flux, and probably will
	not compile or run for a while. I'm concentrating on PowerManager before
	I work anymore on the GNOME GUI.

	* www/* : Updated the directory with new php based layout from Jaap.

2005-03-25  Richard Hughes  <richard@hughsie.com>

	* prefs.c, preferences.glade : rebuild menus...
	New file structure, with tabbed layout and more options. There are
	no schemes now, as they make no logical sense in the current format.

	* g-p-m.schemas.in, added new properties for policy, and removed schemes.

	* docs/index.html, change references to module head to gnome-power
	For GNOME Power Manager to build in jhbuild, the CVS module name must
	be similar to the project. Renamed head to gnome-power.

	* gnome-power.modules, new file:
	Added template for jhbuild users, thanks Jaap Haitsma!

	* TODO, Added list of things to do!
	* NEWS, Added list of releases, well, both of them.
	* README, Added link to website.
	* HACKING, Added plea for help!

2005-03-24  Richard Hughes  <richard@hughsie.com>

	* src/common.c, new function : updateLogic()
	This function runs through the old state, calculates the new
	state, then performs and notification actions. It obsoletes
	most of do_action() and all of the hasBatteriesCheck type code.

	* src/gpm.c, Misc, Hooks added to most of the update code to support
	updateLogic (where appropriate).

	* src/common.h, make enums match CodingStyle, also added lots more
	states to the StateData structure to support updateLogic().

	* src/common.c, Made the percentage/mWh calculations more common, and more
	resistant to errors.

	* src/prefs.c, Made the PowerState ComboBox change the others according to
	policy. Also values now populated dynamically, not in the glade file.
	Static policy in use, and documentation has been updated.

2005-03-23  Richard Hughes  <richard@hughsie.com>

	* src/prefs.c, new file:  - also imported all the pixmaps into
	cvs and worked trying to connect up all the signals.

	* src/gpm.c: Added new option to drop-down on all the icons for preferences
	dialogue, and set the file to execute.

	* src/common.c: Also added preliminary gconf backend, "Preferences" will
	dynamically adjust it's output depending on the gconf settings.

	* Removed some compiled files that snuck into CVS.

2005-03-22  Richard Hughes  <richard@hughsie.com>

	* src/properties.glade, new file:
	Added preliminary glade properties file, with thanks to David Zeuthen
	for the original.

	* mkinstalldirs, new file: Add a needed file for "make install". Oops.

2005-03-21  Richard Hughes  <richard@hughsie.com>

	* Initial release of 0.0.2
